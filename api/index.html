<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Solid Application Interoperability Operations and API</title>
  <meta content="w3c/ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <meta content="Bikeshed version e8cbf4ed2, updated Fri Sep 10 10:21:28 2021 -0700" name="generator">
  <link href="https://solid.github.io/data-interoperability-panel/api/" rel="canonical">
  <meta content="8eb0bafc3d5fdc4b395537716a7b438927a67716" name="document-revision">
<style>
table.permissions thead tr {
  font-size: 12px;
  text-align: left;
}

table.permissions th {
  text-align: left;
}

table.permissions tbody tr:nth-child(even) {
  background-color: lightgray;
  font-size: 10px;
}

table.permissions tbody td {
  font-size: 10px;
  text-align: left;
}

table.classinfo thead tr th[colspan] {
  text-align: left;
  font-size: 15px;
}

table.classinfo thead tr th {
  text-align: left;
  font-size: 14px;
}

table.classinfo tbody tr:nth-child(odd) {
  background-color: lightgray;
  font-size: 12px;
}

table.classinfo tbody tr td {
  font-size: 12px;
}

table.tree thead tr {
  font-size: 14px;
}

table.tree tbody tr:nth-child(even) {
  background-color: lightgray;
  font-size: 14px;
}

table.tree tbody td {
  font-size: 12px;
}

table.intersecting thead tr {
  font-size: 14px ;
}

table.intersecting tbody tr:nth-child(odd) {
  background-color: lightgray;
  font-size: 14px;
}

table.intersecting tbody td {
  font-size: 13px;
  vertical-align: top ;
  text-align: left;
}

table.intersecting td[colspan] {
  text-align: left;
}

table.operation {
  border-collapse: separate;
  border: 3px solid #808080;
  margin-bottom: .5em;
}

table.operation thead tr {
  font-size: 14px;
}

table.operation thead th {
  background-color: #005A9C;
  color: #FFF;
}

table.operation th[colspan] {
  text-align: left;
}

table.operation td[colspan] {
  text-align: left;
}

table.operation tbody td {
  font-size: 13px;
  text-align: left;
}

table.operation code {
  background-color: #DCDCDC;
  color: #000;
  font-size: 13px;
  padding-left: .2em;
  padding-right: .2em;
  padding-top: .05em;
  padding-bottom: .05em;
}

.opdetails code {
  background-color: #DCDCDC;
  color: #000;
  font-weight: bold;
  font-size: 13px;
  padding-left: .2em;
  padding-right: .2em;
  padding-top: .05em;
  padding-bottom: .05em;
}

.opdetails ol {
  margin-left: 0;
  padding-left: 1em;
}

pre {
  font-size: .8em;
}

figcaption {
  text-align: left;
}

a[data-link-type=dfn] {
  color: #000000;
}

a[href*=".ttl"] {
  color: #339966;
  border-bottom: 1px solid #339966;
}

a[href^="#class"] {
  color: #339966;
  border-bottom: 1px solid #339966;
}

a.vocab {
  color: #339966;
  border-bottom: 1px solid #339966;
}

a[href*=".shex"] {
  color: #cc2900;
  border-bottom: 1px solid #cc2900;
}

a[href^="#shex"] {
  color: #cc2900;
  border-bottom: 1px solid #cc2900;
}

a[href*=".tree"] {
  color: #e68a00;
  border-bottom: 1px solid #e68a00;
}

a[href^="#tree"] {
  color: #e68a00;
  border-bottom: 1px solid #e68a00;
}

em.rfc2119 {
  text-transform: lowercase;
  font-variant: small-caps;
  font-style: normal;
  font-size: 18px;
  color: #900;
}

</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Solid Application Interoperability Operations and API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2021-09-14">14 September 2021</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://solid.github.io/data-interoperability-panel/api/">https://solid.github.io/data-interoperability-panel/api/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/solid/data-interoperability-panel/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Justin Bingham</span>
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Eric Prud'hommeaux</span>
     <dd class="editor p-author h-card vcard"><span class="p-name fn">elf Pavlik</span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"> MIT License Copyright 2019 - 2020 W3C Solid Community Group </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification details a set of algorithms and operations used by the

	Solid Application Interoperability Specification](https://solid.github.io/data-interoperability-panel/api/).</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#ar"><span class="secno">1</span> <span class="content">Registering Agents</span></a>
     <ol class="toc">
      <li><a href="#ar-lookup"><span class="secno">1.1</span> <span class="content">Lookup Agent Registration</span></a>
     </ol>
    <li>
     <a href="#datareg"><span class="secno">2</span> <span class="content">Data Registration</span></a>
     <ol class="toc">
      <li><a href="#datareg-load"><span class="secno">2.1</span> <span class="content">Load Data Registration</span></a>
      <li><a href="#datareg-create"><span class="secno">2.2</span> <span class="content">Create Data Registration</span></a>
      <li><a href="#datareg-create-instance"><span class="secno">2.3</span> <span class="content">Create Data Instance</span></a>
      <li><a href="#datareg-delete"><span class="secno">2.4</span> <span class="content">Delete Data Registration</span></a>
      <li><a href="#datareg-delete-instance"><span class="secno">2.5</span> <span class="content">Delete Data Instance</span></a>
     </ol>
    <li>
     <a href="#authz"><span class="secno">3</span> <span class="content">Data Authorization</span></a>
     <ol class="toc">
      <li><a href="#present-grant"><span class="secno">3.1</span> <span class="content">Presenting an Access Grant</span></a>
      <li><a href="#authz-apprequest"><span class="secno">3.2</span> <span class="content">Application Requests Access</span></a>
      <li><a href="#authz-agentrequest"><span class="secno">3.3</span> <span class="content">Another Agent Requests Access</span></a>
      <li><a href="#authz-controllershare"><span class="secno">3.4</span> <span class="content">Controller Shares Access</span></a>
      <li><a href="#authz-controllerinvite"><span class="secno">3.5</span> <span class="content">Controller Shares Access with Invited Agent</span></a>
      <li><a href="#authz-services"><span class="secno">3.6</span> <span class="content">Application Services</span></a>
     </ol>
    <li>
     <a href="#needs"><span class="secno">4</span> <span class="content">Access Needs</span></a>
     <ol class="toc">
      <li><a href="#get-access-dec"><span class="secno">4.1</span> <span class="content">Get Access Decorator Resource</span></a>
      <li><a href="#get-group-dec"><span class="secno">4.2</span> <span class="content">Get Access Need Group Decorator</span></a>
      <li><a href="#get-need-dec"><span class="secno">4.3</span> <span class="content">Get Access Need Decorator</span></a>
     </ol>
    <li>
     <a href="#grants"><span class="secno">5</span> <span class="content">Access Grants</span></a>
     <ol class="toc">
      <li><a href="#grants-initializegrant"><span class="secno">5.1</span> <span class="content">Initialize Grant</span></a>
      <li><a href="#grants-initializeinvitation"><span class="secno">5.2</span> <span class="content">Initialize Invitation</span></a>
      <li><a href="#grants-initializedatagrant"><span class="secno">5.3</span> <span class="content">Initialize Data Grant</span></a>
      <li><a href="#grants-initializetrustedgrant"><span class="secno">5.4</span> <span class="content">Initialize Trusted Grant</span></a>
      <li><a href="#grants-loadgrant"><span class="secno">5.5</span> <span class="content">Load Grant</span></a>
      <li><a href="#grants-loadinvitation"><span class="secno">5.6</span> <span class="content">Load Invitation</span></a>
      <li><a href="#grants-recordgrant"><span class="secno">5.7</span> <span class="content">Record Grant</span></a>
      <li><a href="#grants-recordinvitation"><span class="secno">5.8</span> <span class="content">Record Invitation</span></a>
      <li><a href="#grants-deliverinvitation"><span class="secno">5.9</span> <span class="content">Deliver Invitation</span></a>
      <li><a href="#grants-validateinvitation"><span class="secno">5.10</span> <span class="content">Validate Invitation</span></a>
      <li><a href="#apply-permissions"><span class="secno">5.11</span> <span class="content">Apply Permissions</span></a>
      <li><a href="#apply-data-permissions"><span class="secno">5.12</span> <span class="content">Apply Data Permissions</span></a>
      <li><a href="#apply-data-registration-permissions"><span class="secno">5.13</span> <span class="content">Apply Data Registration Permissions</span></a>
      <li><a href="#get-shape-tree-reference"><span class="secno">5.14</span> <span class="content">Get Shape Tree Reference</span></a>
      <li><a href="#apply-trusted-permissions"><span class="secno">5.15</span> <span class="content">Apply Trusted Permissions</span></a>
      <li><a href="#apply-resource-permissions"><span class="secno">5.16</span> <span class="content">Apply Resource Permissions</span></a>
      <li><a href="#apply-conditional-permissions"><span class="secno">5.17</span> <span class="content">Apply Conditional Resource Permissions</span></a>
      <li><a href="#remove-resource-permissions"><span class="secno">5.18</span> <span class="content">Remove Resource Permissions</span></a>
      <li><a href="#deny-access-need-group"><span class="secno">5.19</span> <span class="content">Deny Access Need Group</span></a>
      <li><a href="#deny-data-grant"><span class="secno">5.20</span> <span class="content">Deny Data Grant</span></a>
      <li><a href="#select-all-data-instances"><span class="secno">5.21</span> <span class="content">Select All Data Instances</span></a>
      <li><a href="#select-all-inherited-data-instances"><span class="secno">5.22</span> <span class="content">Select All Inherited Data Instances</span></a>
      <li><a href="#select-data-instance"><span class="secno">5.23</span> <span class="content">Select Specific Data Instance</span></a>
      <li><a href="#select-inherited-data-instance"><span class="secno">5.24</span> <span class="content">Select Inherited Data Instance</span></a>
      <li><a href="#select-inherited-data-instance①"><span class="secno">5.25</span> <span class="content">Select Specific Inherited Data Instance</span></a>
      <li><a href="#select-trusted-registry-set"><span class="secno">5.26</span> <span class="content">Select Trusted Registry Set</span></a>
      <li><a href="#select-trusted-registry"><span class="secno">5.27</span> <span class="content">Select Specific Trusted Registry</span></a>
      <li><a href="#deny-trusted-grant"><span class="secno">5.28</span> <span class="content">Deny Trusted Grant</span></a>
     </ol>
    <li>
     <a href="#receipts"><span class="secno">6</span> <span class="content">Access Receipts</span></a>
     <ol class="toc">
      <li><a href="#provide-access-receipt"><span class="secno">6.1</span> <span class="content">Provide Access Receipt</span></a>
      <li><a href="#provide-receipt-in-registration"><span class="secno">6.2</span> <span class="content">Provide Receipt in Application Registration</span></a>
      <li><a href="#provide-receipt-in-message"><span class="secno">6.3</span> <span class="content">Provide Receipt in Message</span></a>
      <li><a href="#record-access-receipt"><span class="secno">6.4</span> <span class="content">Record Access Receipt</span></a>
      <li><a href="#load-access-receipt"><span class="secno">6.5</span> <span class="content">Load Access Receipt</span></a>
     </ol>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="ar"><span class="secno">1. </span><span class="content">Registering Agents</span><a class="self-link" href="#ar"></a></h2>
   <p>The following operations pertain to <a href="https://solid.github.io/data-interoperability-panel/specification/#ar">Registering Agents</a> in the <a data-link-type="biblio" href="#biblio-sai">Solid Application Interoperability Specification</a>.</p>
   <h3 class="heading settled" data-level="1.1" id="ar-lookup"><span class="secno">1.1. </span><span class="content">Lookup Agent Registration</span><a class="self-link" href="#ar-lookup"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation returns an <a data-link-type="dfn">Agent Registration</a> to an <a data-link-type="dfn">Agent</a> with appropriate credentials to receive it. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>ID</code>
      <td>URI <a data-link-type="dfn">identity</a> of a given <a data-link-type="dfn">Social Agent</a>
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Agent Registration</a>
      <td><code>AR</code> Matching the input <code>ID</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>AA</code> be the IRI object value of <code>interop:hasAuthorizationAgent</code> in
the graph returned by a <code>HEAD</code> or <code>GET</code> on <code>ID</code></p>
     <li data-md>
      <p>Send a <code>HEAD</code> or <code>GET</code> request to <code>AA</code>, authenticated as <code>ID</code></p>
     <li data-md>
      <p>Let <code>AR</code> be the IRI value of <code>anchor</code> in the <code>HTTP Link</code> header of the HTTP Response
with relation type <code>http://www.w3.org/ns/solid/interop#registeredAgent</code>, and 
authenticated <a data-link-type="dfn">Social Agent’s</a> WebID as the link target.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="2" id="datareg"><span class="secno">2. </span><span class="content">Data Registration</span><a class="self-link" href="#datareg"></a></h2>
   <p>The following operations pertain to <a href="https://solid.github.io/data-interoperability-panel/specification/#datareg">Data Registration</a> in the <a data-link-type="biblio" href="#biblio-sai">Solid Application Interoperability Specification</a>.</p>
   <p>Registering data in a <a data-link-type="dfn">Data Registry</a> is primarily concerned with the
following two operations:</p>
   <ul>
    <li data-md>
     <p>Registering new <em>data types</em> as <a data-link-type="dfn">Data Registrations</a></p>
    <li data-md>
     <p>Storing and registering new <em>instances of those data types</em> as <a data-link-type="dfn">Data Instances</a></p>
   </ul>
   <p>The following operations allow for the lookup, creation, and deletion
of <a data-link-type="dfn">Data Registrations</a> and <a data-link-type="dfn">Data Instances</a> in a <a data-link-type="dfn">Data Registry</a>.</p>
   <ul>
    <li data-md>
     <p><a href="#datareg-load">§ 2.1 Load Data Registration</a> - Load an existing <a data-link-type="dfn">Data Registration</a></p>
    <li data-md>
     <p><a href="#datareg-create">§ 2.2 Create Data Registration</a> - Create a new <a data-link-type="dfn">Data Registration</a></p>
    <li data-md>
     <p><a href="#datareg-create-instance">§ 2.3 Create Data Instance</a> - Create a new <a data-link-type="dfn">Data Instance</a> for
a given <a data-link-type="dfn">Data Registration</a></p>
    <li data-md>
     <p><a href="#datareg-delete">§ 2.4 Delete Data Registration</a> - Delete a <a data-link-type="dfn">Data Registration</a></p>
    <li data-md>
     <p><a href="#datareg-delete-instance">§ 2.5 Delete Data Instance</a> - Delete a <a data-link-type="dfn">Data Instance</a> for
a given <a data-link-type="dfn">Data Registration</a></p>
   </ul>
   <p class="note" role="note"><span>Note:</span> Managing <a data-link-type="dfn">Data Registrations</a> and the <a data-link-type="dfn">Data Instances</a> contained within them is inextricably linked to permissioning the data
for effective use and secure collaboration. This is covered at length
in <a href="https://solid.github.io/data-interoperability-panel/specification/#authz">Solid Application Interoperability § authz</a>.</p>
   <h3 class="heading settled" data-level="2.1" id="datareg-load"><span class="secno">2.1. </span><span class="content">Load Data Registration</span><a class="self-link" href="#datareg-load"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation returns a <a data-link-type="dfn">Data Registration</a> the corresponds
        to a given <a data-link-type="dfn">shape tree</a> in a <a data-link-type="dfn">Data Registry</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TREE</code>
      <td><a data-link-type="dfn">Shape tree</a> to match against
     <tr>
      <td><code>REGISTRY</code>
      <td><a data-link-type="dfn">Data Registry</a> to look for a match within
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Data Registration</a>
      <td>Loaded by matching against <code>TREE</code> in <code>REGISTRY</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return <code>404</code> if <code>TREE</code> or <code>REGISTRY</code> cannot be successfully dereferenced.</p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Data Registration</a> <code>REGISTRATION</code> included
in <code>REGISTRY hasRegistration</code></p>
      <ol>
       <li data-md>
        <p>return <code>REGISTRATION</code> if <code>REGISTRATION registeredShapeTree</code> == <code>TREE</code></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="2.2" id="datareg-create"><span class="secno">2.2. </span><span class="content">Create Data Registration</span><a class="self-link" href="#datareg-create"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation creates a new <a data-link-type="dfn">Data Registration</a> in a <a data-link-type="dfn">Data Registry</a> for a specific <a data-link-type="dfn">shape tree</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TREE</code>
      <td><a data-link-type="dfn">Shape tree</a> to register
     <tr>
      <td><code>TYPE</code>
      <td>Optional <a href="https://www.w3.org/TR/rdf-schema/#ch_type">rdf:type</a> to associate with the registration
     <tr>
      <td><code>REGISTRY</code>
      <td><a data-link-type="dfn">Data Registry</a> where the registration will be created
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Data Registration</a>
      <td>Created for <code>TREE</code> in <code>REGISTRY</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return <code>404</code> if <code>TREE</code> or <code>REGISTRY</code> cannot be successfully dereferenced.</p>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return <code>400</code> if an existing <a data-link-type="dfn">Data Registration</a> is returned from <a href="#datareg-load">§ 2.1 Load Data Registration</a> with 
inputs: <code>TREE</code>, <code>REGISTRY</code></p>
     <li data-md>
      <p>Let <code>REG</code> be a newly initialized <a data-link-type="dfn">Data Registration</a></p>
     <li data-md>
      <p>Let <code>REG registeredBy</code> be the current <a data-link-type="dfn">Social Agent</a></p>
     <li data-md>
      <p>Let <code>REG registeredWith</code> be the <a data-link-type="dfn">identity</a> of the <a data-link-type="dfn">Application</a> executing the operation</p>
     <li data-md>
      <p>Let <code>REG registeredAt</code> be the current date and time</p>
     <li data-md>
      <p>Let <code>REG updatedAt</code> be the current date and time</p>
     <li data-md>
      <p>Let <code>REG registeredShapeTree</code> be <code>TREE</code></p>
     <li data-md>
      <p>Let <code>REG registeredType</code> be <code>TYPE</code> if <code>TYPE</code> is not empty</p>
     <li data-md>
      <p>PUT <code>REG</code> into the <code>REGISTRY</code> container</p>
      <ol>
       <li data-md>
        <p>A <a href="https://www.ietf.org/rfc/rfc4122.txt">UUID</a> <em class="rfc2119">MUST</em> be assigned as the resource name.</p>
       <li data-md>
        <p><a href="https://shapetrees.github.io/specification/spec#plant-shapetree">Plant</a> <code>TREE</code> with <code>REG</code> as the Target Container.</p>
      </ol>
     <li data-md>
      <p>Assign permissions for <code>REG</code> per the <a href="https://solid.github.io/data-interoperability-panel/specification/#datareg-permissions">Solid Application Interoperability § datareg-permissions</a></p>
     <li data-md>
      <p>Link <code>REG</code> to <code>REGISTRY</code> via <code>REGISTRY hasRegistration</code></p>
     <li data-md>
      <p>Return <code>REG</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="2.3" id="datareg-create-instance"><span class="secno">2.3. </span><span class="content">Create Data Instance</span><a class="self-link" href="#datareg-create-instance"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This operation will create a new <a data-link-type="dfn">Data Instance</a> for
        a given <a data-link-type="dfn">Data Registration</a>. It must be a conformant instance of
        the <a data-link-type="dfn">shape tree</a> registered with the <a data-link-type="dfn">Data Registration</a>, per
        the validation structure detailed in <a href="https://solid.github.io/data-interoperability-panel/specification/#datareg-hierarchy">Solid Application Interoperability § datareg-hierarchy</a>. 
       <p>Assumes that a <a data-link-type="dfn">Data Registration</a> has already been loaded
        by <a href="#datareg-load">§ 2.1 Load Data Registration</a> and provided as input.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>REGISTRATION</code>
      <td><a data-link-type="dfn">Data Registration</a> to associated the new <a data-link-type="dfn">Data Instance</a> with
     <tr>
      <td><code>INSTANCE</code>
      <td>Instance corresponding with <code>REGISTRATION registeredShapeTree</code>
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Data Instance</a>
      <td>Created for <code>REGISTRATION</code> in <code>REGISTRY</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>PUT <code>INSTANCE</code> into the <code>REGISTRATION</code> container</p>
      <ol>
       <li data-md>
        <p>A <a href="https://www.ietf.org/rfc/rfc4122.txt">UUID</a> <em class="rfc2119">MUST</em> be assigned as the resource name.</p>
       <li data-md>
        <p>A <a href="https://shapetrees.github.io/specification/spec#create-data-instance">target shape tree</a> <em class="rfc2119">MUST</em> be assigned via the <code>rel=http://shapetrees.org/#targetShapeTree</code> HTTP Link relation</p>
       <li data-md>
        <p>A <a href="https://shapetrees.github.io/specification/spec#create-data-instance">focus node</a> for shape tree validation <em class="rfc2119">MUST</em> be assigned
via the <code>rel=http://shapetrees.org/#FocusNode</code> HTTP Link relation</p>
      </ol>
     <li data-md>
      <p>Return <code>INSTANCE</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="2.4" id="datareg-delete"><span class="secno">2.4. </span><span class="content">Delete Data Registration</span><a class="self-link" href="#datareg-delete"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation deletes a <a data-link-type="dfn">Data Registration</a> from a <a data-link-type="dfn">Data Registry</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>REGISTRATION</code>
      <td><a data-link-type="dfn">Data Registration</a> to delete
     <tr>
      <td><code>REGISTRY</code>
      <td><a data-link-type="dfn">Data Registry</a> of <code>REGISTRATION</code>
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td>HTTP Status Code
      <td>As returned from server
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return <code>404</code> if <code>REGISTRATION</code> cannot be successfully dereferenced.</p>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return <code>400</code> if <code>REGISTRATION</code> contains one or more <a data-link-type="dfn">Data Instances</a>.</p>
     <li data-md>
      <p>Remove <code>REGISTRATION</code> from the graph of <code>REGISTRY</code> via <code>REGISTRY hasRegistration</code></p>
     <li data-md>
      <p>DELETE <code>REGISTRATION</code></p>
    </ol>
   </div>
   <p class="issue" id="issue-1c6aa834"><a class="self-link" href="#issue-1c6aa834"></a> Cleanup of related data may need to be specified</p>
   <h3 class="heading settled" data-level="2.5" id="datareg-delete-instance"><span class="secno">2.5. </span><span class="content">Delete Data Instance</span><a class="self-link" href="#datareg-delete-instance"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation deletes a <a data-link-type="dfn">Data Instance</a> from a <a data-link-type="dfn">Data Registration</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>INSTANCE</code>
      <td><a data-link-type="dfn">Data Instance</a> to delete
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td>HTTP Status Code
      <td>As returned from server
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return <code>404</code> if <code>INSTANCE</code> cannot be successfully dereferenced.</p>
     <li data-md>
      <p>If <code>INSTANCE</code> is a container</p>
      <ol>
       <li data-md>
        <p>Let <code>RESOURCES</code> be a hierarchy of all resources contained by <code>INSTANCE</code>,
including any child containers and resources.</p>
       <li data-md>
        <p>DELETE each <code>RESOURCE</code> in <code>RESOURCES</code>, iterating up from the bottom
of the <code>RESOURCES</code> hierarchy</p>
      </ol>
     <li data-md>
      <p>DELETE <code>INSTANCE</code></p>
    </ol>
   </div>
   <p class="issue" id="issue-1c6aa834①"><a class="self-link" href="#issue-1c6aa834①"></a> Cleanup of related data may need to be specified</p>
   <h2 class="heading settled" data-level="3" id="authz"><span class="secno">3. </span><span class="content">Data Authorization</span><a class="self-link" href="#authz"></a></h2>
   <p>The following workflows represent the <a href="https://solid.github.io/data-interoperability-panel/specification/#authz">Data Authorization</a> patterns enabled by the <a data-link-type="biblio" href="#biblio-sai">Solid Application Interoperability Specification</a>.</p>
   <h3 class="heading settled" data-level="3.1" id="present-grant"><span class="secno">3.1. </span><span class="content">Presenting an Access Grant</span><a class="self-link" href="#present-grant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This workflow details how an <a data-link-type="dfn">Access Grant</a> is 
      presented to a given <a data-link-type="dfn">Social Agent</a> for data in their control, 
      based on the <a data-link-type="dfn">Access Need Groups</a> associated. 
       <p>Each <a data-link-type="dfn">Access Grant</a> is associated with a specific <a data-link-type="dfn">Access Grant Subject</a>, and one or more <a data-link-type="dfn">Access Need Groups</a>. 
      The <a data-link-type="dfn">Access Grant Subject</a> may be another <a data-link-type="dfn">Agent</a>, an <a data-link-type="dfn">Agent</a> using an <a data-link-type="dfn">Application</a>, or an <a data-link-type="dfn">Application</a> operating as an <a data-link-type="dfn">Agent</a>.</p>
       <p>Access Grant presentation may be invoked from a number of
      workflows and contexts, including but not limited to <a href="#authz-apprequest">§ 3.2 Application Requests Access</a>, <a href="#authz-agentrequest">§ 3.3 Another Agent Requests Access</a>, <a href="#authz-controllershare">§ 3.4 Controller Shares Access</a>, and <a href="#authz-controllerinvite">§ 3.5 Controller Shares Access with Invited Agent</a>.</p>
       <p>This workflow is composed of several operations:</p>
       <ol>
        <li data-md>
         <p><a href="#present-grant">§ 3.1 Presenting an Access Grant</a></p>
         <ol>
          <li data-md>
           <p><a href="#present-needgroup">§ 3.1.1 Presenting an Access Need Group</a> - Called for each <a data-link-type="dfn">Access Need Group</a></p>
           <ol>
            <li data-md>
             <p><a href="#present-need">§ 3.1.2 Presenting a Data Access Need</a> - Called for each <a data-link-type="dfn">Access Need</a> in the <a data-link-type="dfn">Access Need Group</a></p>
            <li data-md>
             <p><a href="#present-trustedneed">§ 3.1.3 Presenting a Trusted Need</a> - Called for each <a data-link-type="dfn">Trusted Need</a> in
  the <a data-link-type="dfn">Access Need Group</a></p>
           </ol>
         </ol>
       </ol>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>SUBJECT</code>
      <td>This may be a tuple of <a data-link-type="dfn">Social Agent</a> and <a data-link-type="dfn">Application</a> in the 
      case of a <a data-link-type="dfn">weakly identifiable application</a>, or <a data-link-type="dfn">Application</a> and <a data-link-type="dfn">Application</a> in the case
      of a <a data-link-type="dfn">strongly identifiable application</a>
     <tr>
      <td><code>NEEDGROUPS</code>
      <td><a data-link-type="dfn">Access Need Groups</a> to use when a new <a data-link-type="dfn">Access Grant</a> is being initialized
   </table>
   <p class="note" role="note"><span>Note:</span> All user experience herein is meant to inform how the
data model and operations work. The design and style should be 
considered non-normative. Example data has been incorporated into 
the provided designs to further comprehension of the proposed 
workflow.</p>
   <figure id="fig-present-grant">
    <figcaption>An example <a data-link-type="dfn">Access Grant</a> for an Application.</figcaption>
     <img src="diagrams/present-grant.svg" width="100%/"> 
   </figure>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>GRANT</code> be an existing <a data-link-type="dfn">Access Grant</a> for <code>SUBJECT</code> returned by <a href="#grants-loadgrant">§ 5.5 Load Grant</a></p>
      <ol>
       <li data-md>
        <p>If <code>GRANT</code> is missing, create one via <a href="#grants-initializegrant">§ 5.1 Initialize Grant</a></p>
      </ol>
     <li data-md>
      <p>Present information about the <a data-link-type="dfn">Application</a> <code>APP</code> if the <a data-link-type="dfn">Access Grant Subject</a> is for an <a data-link-type="dfn">Application</a>:</p>
      <ol>
       <li data-md>
        <p>Application Name - <code>APP applicationName</code></p>
       <li data-md>
        <p>Application Identity - <code>APP</code> URI</p>
       <li data-md>
        <p>Application Author Name - <code>APP applicationAuthorName</code></p>
       <li data-md>
        <p>Application Author Identity - <code>APP applicationAuthor</code></p>
       <li data-md>
        <p>Application Thumbnail - <code>APP applicationThumbnail</code></p>
       <li data-md>
        <p>Application Summary - <code>APP applicationDescription</code></p>
      </ol>
     <li data-md>
      <p>Present information about the <a data-link-type="dfn">Social Agent</a> <code>AGENT</code> if the <a data-link-type="dfn">Access Grant Subject</a> is not an <a data-link-type="dfn">Application</a></p>
      <ol>
       <li data-md>
        <p>Agent Name <code>AGENT fullName</code></p>
       <li data-md>
        <p>Agent Identity - <code>AGENT</code> URI</p>
      </ol>
     <li data-md>
      <p>Call <a href="#present-needgroup">§ 3.1.1 Presenting an Access Need Group</a> for each <a data-link-type="dfn">Access Need Group</a> linked
via <code>GRANT hasAccessNeedGroup</code>.</p>
     <li data-md>
      <p>Present an option to authorize the grant by calling <a href="#grants-recordgrant">§ 5.7 Record Grant</a>,
or cancel.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="3.1.1" id="present-needgroup"><span class="secno">3.1.1. </span><span class="content">Presenting an Access Need Group</span><a class="self-link" href="#present-needgroup"></a></h4>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This sub-operation of <a href="#present-grant">§ 3.1 Presenting an Access Grant</a> presents an 
      input <a data-link-type="dfn">Access Need Group</a> associated with a specific <a data-link-type="dfn">Access Grant</a>. 
       <p>Each <a data-link-type="dfn">Access Need Group</a> represents a set of <a data-link-type="dfn">Access Needs</a> and/or <a data-link-type="dfn">Trusted Needs</a>.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GROUP</code>
      <td>The <a data-link-type="dfn">Access Need Group</a> to present
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>GROUP</code> is linked to
   </table>
   <figure id="fig-present-needgroup">
    <figcaption> Depicting an <a data-link-type="dfn">Access Need</a> associated with a given <a data-link-type="dfn">Access Need Group</a>, and several 
  inheriting <a data-link-type="dfn">Access Needs</a> linked to it. The controller
  chose to grant access to all instances now and in the future. </figcaption>
     <img src="diagrams/present-needgroup.svg" width="100%/"> 
   </figure>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>GDEC</code> be the <a data-link-type="dfn">Access Need Group Decorator</a> linked via <code>GROUP hasAccessNeedGroupDecorator</code></p>
     <li data-md>
      <p>Present information about the <a data-link-type="dfn">Access Need Group</a> <code>GROUP</code></p>
      <ol>
       <li data-md>
        <p>Group Name - <code>GDEC skos:prefLabel</code></p>
       <li data-md>
        <p>Group Description - <code>GDEC skos:definition</code></p>
       <li data-md>
        <p>Grantee Type - <code>GROUP authenticatesAs</code></p>
       <li data-md>
        <p>Necessity - <code>GROUP accessNecessity</code></p>
      </ol>
     <li data-md>
      <p>Allow <code>GROUP</code> to be disabled via <a href="#deny-access-need-group">§ 5.19 Deny Access Need Group</a> if group
necessity is optional</p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Need</a> <code>NEED</code> linked via <code>GROUP hasAccessNeed</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#present-need">§ 3.1.2 Presenting a Data Access Need</a></p>
      </ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Trusted Need</a> <code>TNEED</code> linked via <code>GROUP hasTrustedNeed</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#present-trustedneed">§ 3.1.3 Presenting a Trusted Need</a></p>
      </ol>
    </ol>
   </div>
   <h4 class="heading settled" data-level="3.1.2" id="present-need"><span class="secno">3.1.2. </span><span class="content">Presenting a Data Access Need</span><a class="self-link" href="#present-need"></a></h4>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This sub-operation of <a href="#present-needgroup">§ 3.1.1 Presenting an Access Need Group</a> presents an <a data-link-type="dfn">Access Need</a> for an input <a data-link-type="dfn">Access Need Group</a>. 
       <p>Each discrete <a data-link-type="dfn">Access Need</a> is related to a specific type of
      data, identified by a <a data-link-type="dfn">shape tree</a>.</p>
       <p>Each <a data-link-type="dfn">Access Need</a> directly linked to an <a data-link-type="dfn">Access Need Group</a> may have zero or more inheriting <a data-link-type="dfn">Access Needs</a> associated with it.
      Each inheriting <a data-link-type="dfn">Access Need</a> is presented under the <a data-link-type="dfn">Access Need</a> it is linked to.</p>
       <p>The controller can grant access to all data for the <a data-link-type="dfn">Access Need</a> and the inheriting <a data-link-type="dfn">Access Needs</a>, select 
      specific instances of the <a data-link-type="dfn">Access Need</a> and narrow the 
      inheriting <a data-link-type="dfn">Access Need</a> instances to only those related.
      Manual selection with no inheritance can also be done 
      instead.</p>
       <p>Access to which data has been shared with the controller from other <a data-link-type="dfn">Social Agents</a> is also requested through <a data-link-type="dfn">Access Needs</a>.
      In most cases, controllers won’t need to do fine-grained instance
      selection of remote data, but should be allowed the ability if
      they desire.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>NEED</code>
      <td>The <a data-link-type="dfn">Access Need</a> to present 
     <tr>
      <td><code>GROUP</code>
      <td>The <a data-link-type="dfn">Access Need Group</a> that <code>NEED</code> is linked to
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>GROUP</code> is linked to
   </table>
   <figure id="fig-present-inherited">
    <figcaption> Depicting an <a data-link-type="dfn">Access Need</a> with two selected <a data-link-type="dfn">Data Instances</a>,
  with access to the inheriting <a data-link-type="dfn">Access Needs</a> set based on
  whether there is a link to the selected instances. </figcaption>
     <img src="diagrams/present-needgroup-inherited.svg" width="100%/"> 
   </figure>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Call <a href="#present-need-details">§ 3.1.2.1 Presenting Data Access Need Details</a> to explain the <a data-link-type="dfn">Access Need</a></p>
     <li data-md>
      <p>Let <code>DG</code> be the <a data-link-type="dfn">Data Grant</a> linked via <code>NEED hasDataGrant</code></p>
     <li data-md>
      <p>Manage the scope of data to be granted <code>DG scopeOfGrant</code>:</p>
      <ol>
       <li data-md>
        <p><strong>No Access</strong> - <code>interop:NoAccess</code> (if necessity is optional)</p>
        <ol>
         <li data-md>
          <p>Enable via <a href="#deny-data-grant">§ 5.20 Deny Data Grant</a></p>
        </ol>
       <li data-md>
        <p><strong>All Current and Future</strong> - <code>interop:AllInstances</code></p>
        <ol>
         <li data-md>
          <p>Enable via <a href="#select-all-data-instances">§ 5.21 Select All Data Instances</a></p>
        </ol>
       <li data-md>
        <p><strong>Only Selected Instances</strong> - <code>interop:SelectedInstances</code></p>
        <ol>
         <li data-md>
          <p>Present existing <a data-link-type="dfn">Data Instances</a> corresponding to <code>DG registeredShapeTree</code>, identifying any existing selections
linked via <code>DG hasDataInstance</code></p>
         <li data-md>
          <p>Allow one or more to be chosen</p>
         <li data-md>
          <p>Enable via <a href="#select-data-instance">§ 5.23 Select Specific Data Instance</a>, providing each selected <a data-link-type="dfn">Data Instance</a></p>
        </ol>
      </ol>
     <li data-md>
      <p>For each inheriting <a data-link-type="dfn">Access Need</a> <code>INEED</code> linked via <code>INEED inheritsFromNeed</code></p>
      <ol>
       <li data-md>
        <p>Let <code>IDG</code> be the inheriting <a data-link-type="dfn">Data Grant</a> linked via <code>IDG satisfiesAccessNeed</code></p>
       <li data-md>
        <p>Call <a href="#present-need-details">§ 3.1.2.1 Presenting Data Access Need Details</a> to explain the <a data-link-type="dfn">Access Need</a></p>
        <ol>
         <li data-md>
          <p>Manage the scope of data to be granted <code>IDG scopeOfGrant</code>:</p>
          <ol>
           <li data-md>
            <p><strong>No Access</strong> - <code>interop:NoAccess</code> (if necessity is optional)</p>
            <ol>
             <li data-md>
              <p>Enable via <a href="#deny-data-grant">§ 5.20 Deny Data Grant</a></p>
            </ol>
           <li data-md>
            <p><strong>All Current and Future</strong> - <code>interop:AllInstances</code></p>
            <ol>
             <li data-md>
              <p>Enable via <a href="#select-all-inherited-data-instances">§ 5.22 Select All Inherited Data Instances</a></p>
            </ol>
           <li data-md>
            <p><strong>Only Inherited Instances</strong> - <code>interop:InheritInstances</code> (if <code>DG scopeOfGrant</code> is <code>interop:SelectedInstances</code>)</p>
            <ol>
             <li data-md>
              <p>Present <a data-link-type="dfn">Data Instances</a> of <code>INEED registeredShapeTree</code> linked to all <a data-link-type="dfn">Data Instances</a> for <code>DG</code> via <code>st:traverseViaShapePath</code> of <code>DG registeredShapeTree</code></p>
            </ol>
           <li data-md>
            <p><strong>Only Selected Instances</strong> - <code>interop:SelectedInstances</code></p>
            <ol>
             <li data-md>
              <p>Present existing <a data-link-type="dfn">Data Instances</a> corresponding to <code>IDG registeredShapeTree</code>, identifying any existing 
selections linked via <code>IDG hasDataInstance</code></p>
             <li data-md>
              <p>Allow one or more to be chosen</p>
             <li data-md>
              <p>Enable via <a href="#select-inherited-data-instance">§ 5.24 Select Inherited Data Instance</a>, providing
each selected <a data-link-type="dfn">Data Instance</a>.</p>
            </ol>
          </ol>
        </ol>
      </ol>
    </ol>
    <p class="note" role="note"><span>Note:</span> Access to data shared by other <a data-link-type="dfn">Social Agents</a> is similarly managed per <a data-link-type="dfn">Access Need</a>. User interfaces may opt to present
simpler options, and mix the selection in with local data,
like in the <a href="#fig-present-inherited">figure</a> above. However, for the
comprehension and completeness, options for remote data access are 
presented as follows:</p>
    <p class="issue" id="issue-7e591e60"><a class="self-link" href="#issue-7e591e60"></a> Update this operation after refactoring of <a data-link-type="dfn">Delegated Data Grants</a></p>
    <ol>
     <li data-md>
      <p>Let <code>DDG</code> be the <a data-link-type="dfn">Delegated Data Grants</a> linked via <code>NEED hasDataGrant</code></p>
     <li data-md>
      <p>Manage the scope of data to be granted <code>DDG scopeOfGrant</code>:</p>
      <ol>
       <li data-md>
        <p><strong>No Access</strong> - <code>interop:NoAccess</code> (if necessity is optional)</p>
       <li data-md>
        <p><strong>All Remote Data</strong> - <code>interop:AllRemote</code></p>
       <li data-md>
        <p><strong>All Remote From Agent</strong> - <code>interop:AllRemoteFromAgent</code></p>
        <ol>
         <li data-md>
          <p>Allow one or more to be chosen</p>
        </ol>
       <li data-md>
        <p><strong>Only Selected Remote Data</strong> - <code>interop:SelectedRemote</code></p>
        <ol>
         <li data-md>
          <p>Allow one or more to be chosen</p>
        </ol>
      </ol>
     <li data-md>
      <p>For each inherited <a data-link-type="dfn">Delegated Data Grant</a> <code>INDDG</code> linked via <code>INDDG inheritsFromGrant</code> with a value of <code>DDG</code></p>
      <ol>
       <li data-md>
        <p>Manage the scope of data to be granted <code>INDDG scopeOfGrant</code>:</p>
        <ol>
         <li data-md>
          <p><strong>No Access</strong> - <code>interop:NoAccess</code> (if necessity is optional)</p>
         <li data-md>
          <p><strong>All Remote Data</strong> - <code>interop:AllRemote</code></p>
         <li data-md>
          <p><strong>All Remote From Agent</strong> - <code>interop:AllRemoteFromAgent</code></p>
          <ol>
           <li data-md>
            <p>Allow one or more Agents to be chosen</p>
          </ol>
         <li data-md>
          <p><strong>Only Selected Remote Data</strong> - <code>interop:SelectedRemote</code></p>
          <ol>
           <li data-md>
            <p>Present existing <a data-link-type="dfn">Data Grants</a> and/or <a data-link-type="dfn">Delegated Data Grants</a></p>
           <li data-md>
            <p>Allow one or more to be chosen</p>
          </ol>
        </ol>
      </ol>
    </ol>
   </div>
   <h5 class="heading settled" data-level="3.1.2.1" id="present-need-details"><span class="secno">3.1.2.1. </span><span class="content">Presenting Data Access Need Details</span><a class="self-link" href="#present-need-details"></a></h5>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This sub-operation of <a href="#present-need">§ 3.1.2 Presenting a Data Access Need</a> is used to present specific
      details of an <a data-link-type="dfn">Access Need</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>NEED</code>
      <td>The <a data-link-type="dfn">Access Need</a> to present
   </table>
   <ol>
    <li data-md>
     <p>Let <code>STDEC</code> be the <a data-link-type="dfn">Shape Tree Decorator</a> linked via <code>NEED hasShapeTreeDecorator</code></p>
    <li data-md>
     <p>Let <code>ANDEC</code> be the <a data-link-type="dfn">Access Need Decorator</a> linked via <code>NEED hasAccessNeedDecorator</code></p>
    <li data-md>
     <p>Present information about the <a data-link-type="dfn">Access Need</a>:</p>
     <ol>
      <li data-md>
       <p>Shape Tree Name - <code>STDEC skos:prefLabel</code></p>
      <li data-md>
       <p>Shape Tree Description - <code>STDEC skos:definition</code></p>
      <li data-md>
       <p>Access Modes - <code>NEED accessMode</code>s</p>
      <li data-md>
       <p>Necessity - <code>NEED accessNecessity</code></p>
     </ol>
   </ol>
   <h4 class="heading settled" data-level="3.1.3" id="present-trustedneed"><span class="secno">3.1.3. </span><span class="content">Presenting a Trusted Need</span><a class="self-link" href="#present-trustedneed"></a></h4>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This workflow explains how to present a <a data-link-type="dfn">Trusted Need</a> for
      an input <a data-link-type="dfn">Access Need Group</a> associated with a given <a data-link-type="dfn">Access Grant</a>. 
       <p>Each discrete <a data-link-type="dfn">Trusted Need</a> is related to a specific type of
      trusted resource.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TNEED</code>
      <td>The <a data-link-type="dfn">Trusted Need</a> to present 
     <tr>
      <td><code>GROUP</code>
      <td>The <a data-link-type="dfn">Access Need Group</a> that <code>TNEED</code> is linked to
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>GROUP</code> is linked to
   </table>
   <figure id="fig-present-trustedneed">
    <figcaption> Depicting <a data-link-type="dfn">Trusted Needs</a> for an <a data-link-type="dfn">Application</a> that will be
  used as an authorization agent, requiring elevated access across
  the board. </figcaption>
     <img src="diagrams/present-needgroup-trustedneed.svg" width="100%/"> 
   </figure>
   <ol>
    <li data-md>
     <p>Let <code>TNEED</code> be the <a data-link-type="dfn">Access Need Decorator</a> linked via <code>TNEED hasAccessNeedDecorator</code></p>
    <li data-md>
     <p>Let <code>TG</code> be the <a data-link-type="dfn">Trusted Grant</a> linked via <code>TNEED hasTrustedGrant</code></p>
    <li data-md>
     <p>Present information about the <a data-link-type="dfn">Trusted Need</a>:</p>
     <ol>
      <li data-md>
       <p>Trusted Need Type - <code>STDEC skos:prefLabel</code></p>
      <li data-md>
       <p>Trusted Need Description - <code>STDEC skos:definition</code></p>
      <li data-md>
       <p>Access Modes - <code>TNEED accessMode</code>s</p>
      <li data-md>
       <p>Necessity - <code>TNEED accessNecessity</code></p>
     </ol>
    <li data-md>
     <p>Manage the scope of the trusted grant <code>TG scopeOfGrant</code>:</p>
     <ol>
      <li data-md>
       <p>Next if <code>TNEED trustedWithType</code> is <code>interop:Agent</code></p>
      <li data-md>
       <p><strong>All Registries</strong> - where <code>rdf:type</code> of <a data-link-type="dfn">Registry</a> is <code>TNEED trustedWithType</code></p>
       <ol>
        <li data-md>
         <p>Enable via <a href="#select-trusted-registry-set">§ 5.26 Select Trusted Registry Set</a></p>
       </ol>
      <li data-md>
       <p><strong>Specific TYPE Registries</strong></p>
       <ol>
        <li data-md>
         <p>Present existing <a data-link-type="dfn">Registries</a> where <code>rdf:type</code> is <code>TNEED trustedWithType</code></p>
        <li data-md>
         <p>Allow one or more <a data-link-type="dfn">Registries</a> to be chosen</p>
        <li data-md>
         <p>Enable via <a href="#select-trusted-registry">§ 5.27 Select Specific Trusted Registry</a>, providing each selected <a data-link-type="dfn">Registrys</a></p>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="3.2" id="authz-apprequest"><span class="secno">3.2. </span><span class="content">Application Requests Access</span><a class="self-link" href="#authz-apprequest"></a></h3>
   <p>Let <code>CONTROLLER</code> be a <a data-link-type="dfn">Social Agent</a> that wants to give an <a data-link-type="dfn">Application</a> <code>APP</code> access to data in their control.</p>
   <p>Let <code>APP</code> be the <a data-link-type="dfn">Application</a> that <code>CONTROLLER</code> wishes to use, and must
    grant access to. <code>APP</code> may be an <a data-link-type="dfn">Application</a> that is piloted by the <a data-link-type="dfn">Social Agent</a>, or it may be an autonomous service that operates independently.
    The following workflow applies to both cases.</p>
   <p>Let <code>AUTHZ</code> be an <a data-link-type="dfn">Application</a> trusted by the <a data-link-type="dfn">Social Agent</a> for
    authorization and access control.</p>
   <ol>
    <li data-md>
     <p><code>CONTROLLER</code> decides they’d like to use <code>APP</code></p>
    <li data-md>
     <p><code>CONTROLLER</code> provides their <a data-link-type="dfn">identity</a> to <code>APP</code></p>
    <li data-md>
     <p><code>APP</code> dereferences the <a data-link-type="dfn">identity</a> to
get <code>CONTROLLER</code>'s <a data-link-type="dfn">identity profile document</a>.</p>
    <li data-md>
     <p><code>APP</code> discovers that <code>AUTHZ</code> is an <a data-link-type="dfn">Application</a> that is a <a data-link-type="dfn">Trusted Agent</a> of <code>CONTROLLER</code> for data authorization</p>
    <li data-md>
     <p><code>APP</code> redirects <code>CONTROLLER</code> to <code>AUTHZ</code></p>
     <ol>
      <li data-md>
       <p>Let <code>APPREG</code> be an <a data-link-type="dfn">Application Registration</a> returned by
#appreg-loadappreg with inputs: <code>CONTROLLER</code>, <code>APP</code></p>
      <li data-md>
       <p>If <code>APPREG</code> is empty let <code>APPREG</code> be the <a data-link-type="dfn">Application Registration</a> returned by #appreg-registerapp with inputs: <code>AGENT</code>, <code>APP</code>, <code>REGISTRY</code>.</p>
      <li data-md>
       <p><code>AUTHZ</code> looks in <code>APP</code>'s <a data-link-type="dfn">application profile document</a> for <a data-link-type="dfn">Access Need Groups</a> with an <code>interop:accessScenario</code> of <code>interop:PersonalAccess</code></p>
      <li data-md>
       <p>Any <a data-link-type="dfn">Access Need Groups</a> found are passed to the <a href="#present-grant">§ 3.1 Presenting an Access Grant</a> workflow, which presents them to <code>CONTROLLER</code>.</p>
      <li data-md>
       <p><code>CONTROLLER</code> decides whether to grant <code>APP</code> the access requested.</p>
      <li data-md>
       <p><code>CONTROLLER</code> authorizes the requested <a data-link-type="dfn">Access Need Groups</a> and <a data-link-type="dfn">Access Needs</a>:</p>
       <ol>
        <li data-md>
         <p>The <a href="#grants-recordgrant">§ 5.7 Record Grant</a> operation is invoked</p>
         <ol>
          <li data-md>
           <p>An <a data-link-type="dfn">Access Grant</a> is stored in <code>CONTROLLER</code>'s <a data-link-type="dfn">Access Grant Registry</a>.</p>
          <li data-md>
           <p><a href="#apply-permissions">§ 5.11 Apply Permissions</a> is called to apply permissions based
on the <a data-link-type="dfn">Access Grant</a>.</p>
          <li data-md>
           <p><a href="#provide-access-receipt">§ 6.1 Provide Access Receipt</a> is called to store the <a data-link-type="dfn">Access Receipt</a>. The Application has set <code>interop:receivesAccessReceipt</code> to <code>ReceiptInRegistration</code>, so the <a data-link-type="dfn">Access Receipt</a> is
stored in the <a data-link-type="dfn">Application Registration</a> for <code>APP</code>.</p>
         </ol>
       </ol>
      <li data-md>
       <p><code>AUTHZ</code> redirects <code>CONTROLLER</code> back to <code>APP</code></p>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="3.3" id="authz-agentrequest"><span class="secno">3.3. </span><span class="content">Another Agent Requests Access</span><a class="self-link" href="#authz-agentrequest"></a></h3>
   <p>Let <code>REQUESTER</code> be an <a data-link-type="dfn">Agent</a> requesting data from another <a data-link-type="dfn">Social Agent</a> <code>CONTROLLER</code> with a known <a data-link-type="dfn">identity</a>.</p>
   <p>Let <code>REQAPP</code> be an <a data-link-type="dfn">Application</a> piloted by <code>REQUESTER</code></p>
   <p>Let <code>RAUTHZ</code> be an <a data-link-type="dfn">Application</a> trusted by <code>REQUESTER</code> for
    authorization and access control.</p>
   <p>Let <code>CONTROLLER</code> be a <a data-link-type="dfn">Social Agent</a> in control of data that <code>REQUESTER</code> would like to access.</p>
   <p>Let <code>CAUTHZ</code> be an <a data-link-type="dfn">Application</a> trusted by <code>CONTROLLER</code> for
    authorization and access control.</p>
   <ol>
    <li data-md>
     <p><code>REQUESTER</code> would like access to <code>CONTROLLER</code>'s data.</p>
    <li data-md>
     <p><code>REQUESTER</code> provides <code>CONTROLLER</code>'s <a data-link-type="dfn">identity</a> to <code>REQAPP</code>.</p>
    <li data-md>
     <p><code>REQAPP</code> dereferences <code>CONTROLLER</code>'s <a data-link-type="dfn">identity</a> to get <code>CONTROLLER</code>'s <a data-link-type="dfn">identity profile document</a>.</p>
    <li data-md>
     <p><code>REQAPP</code> uses <a data-link-type="dfn">Access Need Groups</a> from its <a data-link-type="dfn">application profile document</a> with an <code>interop:accessScenario</code> of <code>interop:SharedAccess</code> to identify <a data-link-type="dfn">Access Need Groups</a> to request
from <code>CONTROLLER</code>.</p>
    <li data-md>
     <p><code>CONTROLLER</code> has an <code>interop:receivesAccessReceipt</code> value of <code>ReceiptInMessage</code> in their <a data-link-type="dfn">identity profile document</a>.</p>
    <li data-md>
     <p><code>REQAPP</code> puts the <a data-link-type="dfn">Access Need Groups</a> into an <a data-link-type="dfn">Access Request</a> and posts it to the access inbox identified by <code>interop:hasAccessInbox</code> in the <code>CONTROLLER</code>'s <a data-link-type="dfn">identity profile document</a>.</p>
    <li data-md>
     <p><code>CAUTHZ</code> monitors <code>CONTROLLER</code>'s access inbox autonomously. It notifies <code>CONTROLLER</code> when a new <a data-link-type="dfn">Access Request</a> is received.</p>
     <ol>
      <li data-md>
       <p><code>CONTROLLER</code> clicks a link in the notification from <code>CAUTHZ</code>,
opening the <code>CAUTHZ</code> user interface and invoking the
[[##present-grant]] workflow using the <a data-link-type="dfn">Access Need Groups</a> from
the <a data-link-type="dfn">Access Request</a>.</p>
      <li data-md>
       <p><code>CONTROLLER</code> determines whether they wish to grant the access requested.</p>
      <li data-md>
       <p>Assuming <code>CONTROLLER</code> authorizes a minimum of the
required <a data-link-type="dfn">Access Need Groups</a> and <a data-link-type="dfn">Access Needs</a>,
the <a href="#grants-recordgrant">§ 5.7 Record Grant</a> operation is invoked.</p>
      <li data-md>
       <p><a href="#grants-recordgrant">§ 5.7 Record Grant</a> stores an <a data-link-type="dfn">Access Grant</a> in <code>CONTROLLER</code>'s <a data-link-type="dfn">Access Grant Registry</a>.</p>
       <ol>
        <li data-md>
         <p><a href="#apply-permissions">§ 5.11 Apply Permissions</a> is called to apply permissions based on the <a data-link-type="dfn">Access Grant</a>.</p>
        <li data-md>
         <p><a href="#provide-access-receipt">§ 6.1 Provide Access Receipt</a> is called to deliver the <a data-link-type="dfn">Access Receipt</a>.</p>
         <ol>
          <li data-md>
           <p><code>CAUTHZ</code> dereferences <code>REQUESTER</code>'s <a data-link-type="dfn">identity</a> to get <code>REQUESTER</code>'s <a data-link-type="dfn">identity profile document</a>.</p>
          <li data-md>
           <p><code>REQUESTER</code> has set <code>interop:receivesAccessReceipt</code> to <code>ReceiptInMessage</code>, so the <a data-link-type="dfn">Access Receipt</a> is posted
to the access inbox identified via <code>hasAccessInbox</code> in <code>REQUESTER</code>'s '<a data-link-type="dfn">identity profile document</a>.</p>
         </ol>
       </ol>
     </ol>
    <li data-md>
     <p><code>RAUTHZ</code> monitors <code>REQUESTER</code>'s access inbox autonomously. It notifies <code>REQUESTER</code> when a new <a data-link-type="dfn">Access Receipt</a> is received.</p>
     <ol>
      <li data-md>
       <p><code>REQUESTER</code> clicks the link in the notification, opening the <code>RAUTHZ</code> user interface, and presenting the <a data-link-type="dfn">Access Receipt</a> to <code>REQUESTER</code>.</p>
      <li data-md>
       <p><code>REQUESTER</code> accepts the <a data-link-type="dfn">Access Receipt</a>, and <code>RAUTHZ</code> invokes the <a href="#record-access-receipt">§ 6.4 Record Access Receipt</a> operation.</p>
       <ol>
        <li data-md>
         <p><a href="#record-access-receipt">§ 6.4 Record Access Receipt</a> is called to store the <a data-link-type="dfn">Access Receipt</a> in <code>REQUESTER</code>'s <a data-link-type="dfn">Access Receipt Registry</a>.</p>
        <li data-md>
         <p>Update the <code>REQUESTER</code>'s <a data-link-type="dfn">Agent Registy</a> to reflect
what is in the <a data-link-type="dfn">Access Receipt</a>.</p>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="3.4" id="authz-controllershare"><span class="secno">3.4. </span><span class="content">Controller Shares Access</span><a class="self-link" href="#authz-controllershare"></a></h3>
   <p>Let <code>CONTROLLER</code> be a <a data-link-type="dfn">Social Agent</a> in control of data that
    they would like to authorize <code>RECEIVER</code> to access.</p>
   <p>Let <code>CAPP</code> be an <a data-link-type="dfn">Application</a> piloted by <code>CONTROLLER</code></p>
   <p>Let <code>CAUTHZ</code> be an <a data-link-type="dfn">Application</a> trusted by <code>CONTROLLER</code> for
    authorization and access control.</p>
   <p>Let <code>RECEIVER</code> be an <a data-link-type="dfn">Agent</a> receiving access to data from another <a data-link-type="dfn">Social Agent</a> <code>CONTROLLER</code>.</p>
   <p>Let <code>RAUTHZ</code> be an <a data-link-type="dfn">Application</a> trusted by <code>RECEIVER</code> for
    authorization and access control.</p>
   <ol>
    <li data-md>
     <p><code>CONTROLLER</code> would like to give <code>RECEIVER</code> access to their data.</p>
    <li data-md>
     <p><code>CONTROLLER</code> provides <code>RECEIVER</code>'s <a data-link-type="dfn">identity</a> to <code>CAPP</code>.</p>
    <li data-md>
     <p><code>CAPP</code> dereferences <code>RECEIVER</code>'s <a data-link-type="dfn">identity</a> to get <code>RECEIVER</code>'s <a data-link-type="dfn">identity profile document</a>.</p>
    <li data-md>
     <p><code>CAPP</code> discovers that <code>CAUTHZ</code> is an <a data-link-type="dfn">Application</a> that is a <a data-link-type="dfn">Trusted Agent</a> of <code>CONTROLLER</code> for data authorization</p>
    <li data-md>
     <p><code>CAPP</code> redirects <code>CONTROLLER</code> to <code>CAUTHZ</code></p>
     <ol>
      <li data-md>
       <p><code>CAUTHZ</code> looks in <code>CAPP</code>'s <a data-link-type="dfn">application profile document</a> for <a data-link-type="dfn">Access Need Groups</a> with an <code>interop:accessScenario</code> of <code>interop:SharedAccess</code></p>
      <li data-md>
       <p>Any <a data-link-type="dfn">Access Need Groups</a> found are passed to the [[##present-grant]]
workflow, which presents them to <code>CONTROLLER</code>.</p>
      <li data-md>
       <p><code>CONTROLLER</code> authorizes the data to share with <code>RECEIVER</code> based on
the provided <a data-link-type="dfn">Access Need Groups</a>.</p>
       <ol>
        <li data-md>
         <p>The <a href="#grants-recordgrant">§ 5.7 Record Grant</a> operation is invoked</p>
         <ol>
          <li data-md>
           <p>An <a data-link-type="dfn">Access Grant</a> is stored in <code>CONTROLLER</code>'s <a data-link-type="dfn">Access Grant Registry</a>.</p>
          <li data-md>
           <p><a href="#apply-permissions">§ 5.11 Apply Permissions</a> is called to apply permissions based
on the <a data-link-type="dfn">Access Grant</a>.</p>
          <li data-md>
           <p><a href="#provide-access-receipt">§ 6.1 Provide Access Receipt</a> is called to store the <a data-link-type="dfn">Access Receipt</a>. <code>RECEIVER</code> has set <code>interop:receivesAccessReceipt</code> to <code>ReceiptInMessage</code>, so the <a data-link-type="dfn">Access Receipt</a> is posted
to the access inbox identified via <code>hasAccessInbox</code> in <code>RECEIVER</code>'s '<a data-link-type="dfn">identity profile document</a>.</p>
         </ol>
       </ol>
      <li data-md>
       <p><code>CAUTHZ</code> redirects <code>CONTROLLER</code> back to <code>CAPP</code></p>
     </ol>
    <li data-md>
     <p><code>RAUTHZ</code> monitors <code>RECEIVER</code>'s access inbox autonomously. It notifies <code>RECEIVER</code> when a new <a data-link-type="dfn">Access Receipt</a> is received.</p>
     <ol>
      <li data-md>
       <p><code>RECEIVER</code> clicks the link in the notification, opening the <code>RAUTHZ</code> user interface to review the <a data-link-type="dfn">Access Receipt</a>.</p>
      <li data-md>
       <p><code>RECEIVER</code> accepts the <a data-link-type="dfn">Access Receipt</a>, and <code>RAUTHZ</code> invokes the <a href="#record-access-receipt">§ 6.4 Record Access Receipt</a> operation.</p>
       <ol>
        <li data-md>
         <p><a href="#record-access-receipt">§ 6.4 Record Access Receipt</a> is called to store the <a data-link-type="dfn">Access Receipt</a> in <code>RECEIVER</code>'s <a data-link-type="dfn">Access Receipt Registry</a>.</p>
        <li data-md>
         <p>Update the <code>RECEIVER</code>'s <a data-link-type="dfn">Agent Registry</a> to reflect what
is in the <a data-link-type="dfn">Access Receipt</a>.</p>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="3.5" id="authz-controllerinvite"><span class="secno">3.5. </span><span class="content">Controller Shares Access with Invited Agent</span><a class="self-link" href="#authz-controllerinvite"></a></h3>
   <p>Controlling Agent initiates sharing their data with an Agent that doesn’t
have an identity or a pod.</p>
   <p>Let <code>CONTROLLER</code> be a <a data-link-type="dfn">Social Agent</a> in control of data that
    they would like to authorize <code>INVITEE</code> to access.</p>
   <p>Let <code>CAPP</code> be an <a data-link-type="dfn">Application</a> piloted by <code>CONTROLLER</code></p>
   <p>Let <code>CAUTHZ</code> be an <a data-link-type="dfn">Application</a> trusted by <code>CONTROLLER</code> for
    authorization and access control.</p>
   <p>Let <code>CISERVICE</code> be an <a data-link-type="dfn">Application</a> trusted by <code>CONTROLLER</code> to validate
    invitations made to <code>INVITEE</code>s.</p>
   <p>Let <code>INVITEE</code> be a person without an <a data-link-type="dfn">identity</a> or <a data-link-type="dfn">pod</a> that <code>CONTROLLER</code> would like to authorize to access their data. <code>CONTROLLER</code> knows their
    e-mail address and mobile phone number.</p>
   <p>LET <code>PROVIDER</code> be a service that hosts <a data-link-type="dfn">identities</a> and <a data-link-type="dfn">pods</a> who
    provisions the same for <code>INVITEE</code></p>
   <p>Let <code>PAUTHZ</code> be an <a data-link-type="dfn">Application</a> offered by <code>PROVIDER</code> and trusted by <code>INVITEE</code> for authorization and access control.</p>
   <ol>
    <li data-md>
     <p><code>CONTROLLER</code> would like to give <code>INVITEE</code> access to their data.</p>
    <li data-md>
     <p><code>CONTROLLER</code> provides <code>INVITEE</code>'s e-mail address and mobile number to <code>CAPP</code>.</p>
    <li data-md>
     <p><code>CAPP</code> discovers that <code>CAUTHZ</code> is an <a data-link-type="dfn">Application</a> that is a <a data-link-type="dfn">Trusted Agent</a> of <code>CONTROLLER</code> for data authorization</p>
    <li data-md>
     <p><code>CAPP</code> redirects <code>CONTROLLER</code> to <code>CAUTHZ</code></p>
     <ol>
      <li data-md>
       <p><code>CAUTHZ</code> looks in <code>CAPP</code>'s <a data-link-type="dfn">application profile document</a> for <a data-link-type="dfn">Access Need Groups</a> with an <code>interop:accessScenario</code> of <code>interop:SharedAccess</code></p>
      <li data-md>
       <p>Any <a data-link-type="dfn">Access Need Groups</a> found are passed to
the [[##present-grant]]
workflow, which presents them to <code>CONTROLLER</code>.</p>
      <li data-md>
       <p><code>CONTROLLER</code> authorizes the data to share with <code>INVITEE</code> based on
the provided <a data-link-type="dfn">Access Need Groups</a>.</p>
       <ol>
        <li data-md>
         <p>The <a href="#grants-recordinvitation">§ 5.8 Record Invitation</a> operation is invoked</p>
         <ol>
          <li data-md>
           <p>An <a data-link-type="dfn">Access Invitation</a> is stored in <code>CONTROLLER</code>'s <a data-link-type="dfn">Access Grant Registry</a>.</p>
          <li data-md>
           <p><a href="#grants-deliverinvitation">§ 5.9 Deliver Invitation</a> is called to create an
invitation entry for each <a data-link-type="dfn">Access Invitation Channel</a> in
the <a data-link-type="dfn">Access Invitation</a> with <code>CISERVICE</code></p>
          <li data-md>
           <p>For each <a data-link-type="dfn">Access Invitation Channel</a> in the <a data-link-type="dfn">Access Invitation</a></p>
           <ol>
            <li data-md>
             <p><code>CISERVICE</code> sends a notification to <code>INIVITEE</code> using the
medium associated with the <a data-link-type="dfn">Access Invitation Channel</a> type</p>
           </ol>
         </ol>
       </ol>
      <li data-md>
       <p><code>CAUTHZ</code> redirects <code>CONTROLLER</code> back to <code>CAPP</code></p>
     </ol>
    <li data-md>
     <p><code>INVITEE</code> receives a notification associated with one of the <a data-link-type="dfn">Access Invitation Channels</a>.</p>
     <ol>
      <li data-md>
       <p><code>INVITEE</code> clicks a link in the notification to register an
identity and pod with <code>PROVIDER</code>.</p>
      <li data-md>
       <p><code>INVITEE</code> clicks a link in the notification bringing them to the <code>CISERVICE</code> user interface to validate the invitation by
invoking <a href="#grants-validateinvitation">§ 5.10 Validate Invitation</a>.</p>
       <ol>
        <li data-md>
         <p>If validation is successful, but there are other <a data-link-type="dfn">Access Invitation Channels</a> left to validate, the <code>INVITEE</code> will
be prompted to validate them. Continue until failure or
validation of all <a data-link-type="dfn">Access Invitation Channels</a> are succesful.</p>
        <li data-md>
         <p><code>CISERVICE</code> initializes a new <a data-link-type="dfn">Access Grant</a> via <a href="#grants-initializegrant">§ 5.1 Initialize Grant</a>, using the contents of
the <a data-link-type="dfn">Access Invitation</a>, and the new registered <a data-link-type="dfn">identity</a> for <code>INVITEE</code>.</p>
        <li data-md>
         <p><code>CISERVICE</code> calls <a href="#grants-recordgrant">§ 5.7 Record Grant</a> using the <a data-link-type="dfn">Access Grant</a> initialized from the <a data-link-type="dfn">Access Invitation</a></p>
         <ol>
          <li data-md>
           <p>An <a data-link-type="dfn">Access Grant</a> is stored in <code>CONTROLLER</code>'s <a data-link-type="dfn">Access Grant Registry</a>.</p>
          <li data-md>
           <p><a href="#apply-permissions">§ 5.11 Apply Permissions</a> is called to apply permissions
based on the <a data-link-type="dfn">Access Grant</a>.</p>
          <li data-md>
           <p><a href="#provide-access-receipt">§ 6.1 Provide Access Receipt</a> is called to store the <a data-link-type="dfn">Access Receipt</a>. <code>INVITEE</code> has set <code>interop:receivesAccessReceipt</code> to <code>ReceiptInMessage</code>, so the <a data-link-type="dfn">Access Receipt</a> is posted
to the access inbox identified via <code>hasAccessInbox</code> in <code>INVITEE</code>'s '<a data-link-type="dfn">identity profile document</a>.</p>
         </ol>
       </ol>
     </ol>
   </ol>
   <p class="issue" id="issue-d5f0eb31"><a class="self-link" href="#issue-d5f0eb31"></a> Should we assume that CISERVICE is able to manage grants, or should
it need to redirect through the authorization agent? Perhaps the recommendation
should be that they are combined? Bad separation of concerns?</p>
   <p class="issue" id="issue-d1e70f49"><a class="self-link" href="#issue-d1e70f49"></a> This doesn’t take account a sequencing of validation steps from
one channel to another.</p>
   <h3 class="heading settled" data-level="3.6" id="authz-services"><span class="secno">3.6. </span><span class="content">Application Services</span><a class="self-link" href="#authz-services"></a></h3>
   <h4 class="heading settled" data-level="3.6.1" id="authz-service-authorize"><span class="secno">3.6.1. </span><span class="content">Authorize Data Service</span><a class="self-link" href="#authz-service-authorize"></a></h4>
   <p class="issue" id="issue-abd7def3"><a class="self-link" href="#issue-abd7def3"></a> Define data authorization service</p>
   <h2 class="heading settled" data-level="4" id="needs"><span class="secno">4. </span><span class="content">Access Needs</span><a class="self-link" href="#needs"></a></h2>
   <p>The following operations pertain to <a href="https://solid.github.io/data-interoperability-panel/specification/#needs">Access Needs</a> in the <a data-link-type="biblio" href="#biblio-sai">Solid Application Interoperability Specification</a>.</p>
   <h3 class="heading settled" data-level="4.1" id="get-access-dec"><span class="secno">4.1. </span><span class="content">Get Access Decorator Resource</span><a class="self-link" href="#get-access-dec"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation returns the appropriate <a data-link-type="dfn">Access Decorator Resource</a> from an input <a data-link-type="dfn">Access Decorator Index</a> for the provided language.
      If the provided language is not available, a default language is used instead. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>INDEX</code>
      <td>An <a data-link-type="dfn">Access Decorator Index</a>
     <tr>
      <td><code>LANG</code>
      <td>The <a data-link-type="dfn">Social Agent’s</a> preferred language
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Decorator Resource</a>
      <td>Looked up in the <a data-link-type="dfn">Access Decorator Index</a>, based on the <a data-link-type="dfn">Social Agent’s</a> preferred language
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>USESERIES</code> be <code>INDEX defaultSeries</code></p>
     <li data-md>
      <p>Let <code>USEVERSION</code> be an unassigned <a data-link-type="dfn">Access Decorator Version</a></p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Decorator Series</a> <code>SERIES</code> in <code>INDEX</code></p>
      <ol>
       <li data-md>
        <p>Let <code>USESERIES</code> be <code>SERIES</code> if <code>SERIES usesLanguage</code> == <code>LANG</code></p>
      </ol>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return a status code
of 404 if no <a data-link-type="dfn">Access Decorator Series</a> are found.</p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Decorator Version</a> <code>VERSION</code> in <code>USESERIES hasVersion</code></p>
      <ol>
       <li data-md>
        <p>Let <code>USEVERSION</code> be <code>VERSION</code> if <code>VERSION</code> is a more recent <a href="https://semver.org/">semantic version</a> than <code>USEVERSION</code> or if <code>USEVERSION</code> is unassigned.</p>
      </ol>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return a status code
of 404 if no <a data-link-type="dfn">Access Decorator Versions</a> are found.</p>
     <li data-md>
      <p>Let <code>DECR</code> be the <a data-link-type="dfn">Access Decorator Resource</a> linked
from <code>USEVERSION hasAccessDecoratorResource</code></p>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return a status code
of 404 if <code>DECR</code> is unassigned.</p>
     <li data-md>
      <p>return <code>DECR</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.2" id="get-group-dec"><span class="secno">4.2. </span><span class="content">Get Access Need Group Decorator</span><a class="self-link" href="#get-group-dec"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation returns the appropriate <a data-link-type="dfn">Access Need Group Decorator</a> for an input <a data-link-type="dfn">Access Need Group</a> in the provided language. If the
      provided language is not available, a default language is used instead. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GROUP</code>
      <td>An <a data-link-type="dfn">Access Need Group</a>
     <tr>
      <td><code>LANG</code>
      <td>The <a data-link-type="dfn">Social Agent’s</a> preferred language
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Need Group Decorator</a>
      <td>Associated with <code>GROUP</code> in <code>LANG</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>DECR</code> be the <a data-link-type="dfn">Access Decorator Resource</a> returned by <a href="#get-group-dec">§ 4.2 Get Access Need Group Decorator</a> with inputs: <code>GROUP hasAccessDecoratorIndex</code>, <code>LANG</code></p>
     <li data-md>
      <p>Let <code>USEGDEC</code> be an unassigned <a data-link-type="dfn">Access Need Group Decorator</a></p>
     <li data-md>
      <p>Let <code>GDECS</code> be all <a data-link-type="dfn">Access Need Group Decorators</a> in <code>DECR</code></p>
     <li data-md>
      <p>For each [=Acces Need Group Decorator] <code>GDEC</code> in <code>GDECS</code></p>
     <li data-md>
      <p>Let <code>USEGDEC</code> be <code>GDEC</code> if <code>GDEC hasAccessNeedGroup</code> is <code>GROUP</code></p>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return a status code
of 404 if <code>USEGDEC</code> is unassigned</p>
     <li data-md>
      <p>return <code>USEGDEC</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.3" id="get-need-dec"><span class="secno">4.3. </span><span class="content">Get Access Need Decorator</span><a class="self-link" href="#get-need-dec"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation returns the appropriate <a data-link-type="dfn">Access Need Decorator</a> for an input <a data-link-type="dfn">Access Need</a> in the provided language. If the
      provided language is not available, a default language is used instead. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>NEED</code>
      <td>An <a data-link-type="dfn">Access Need</a>
     <tr>
      <td><code>LANG</code>
      <td>The <a data-link-type="dfn">Social Agent’s</a> preferred language
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Need Decorator</a>
      <td>Associated with <code>NEED</code> in <code>LANG</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>GROUP</code> be <code>NEED inAccessNeedGroup</code></p>
     <li data-md>
      <p>Let <code>DECR</code> be the <a data-link-type="dfn">Access Decorator Resource</a> returned by <a href="#get-group-dec">§ 4.2 Get Access Need Group Decorator</a> with inputs: <code>GROUP hasAccessDecoratorIndex</code>, <code>LANG</code></p>
     <li data-md>
      <p>Let <code>USENDEC</code> be an unassigned <a data-link-type="dfn">Access Need Decorator</a></p>
     <li data-md>
      <p>Let <code>NDECS</code> be all <a data-link-type="dfn">Access Need Decorators</a> in <code>DECR</code></p>
     <li data-md>
      <p>For each [=Acces Need Decorator] <code>NDEC</code> in <code>NDECS</code></p>
     <li data-md>
      <p>Let <code>USENDEC</code> be <code>NDEC</code> if <code>NDEC hasAccessNeedGroup</code> is <code>GROUP</code> and <code>NDEC registeredShapeTree</code> is <code>NEED registeredShapeTree</code></p>
     <li data-md>
      <p><em class="rfc2119">MUST</em> return a status code
of 404 if <code>USENDEC</code> is unassigned</p>
     <li data-md>
      <p>return <code>USENDEC</code></p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="5" id="grants"><span class="secno">5. </span><span class="content">Access Grants</span><a class="self-link" href="#grants"></a></h2>
   <p>The following operations pertain to <a href="https://solid.github.io/data-interoperability-panel/specification/#grants">Access Grants</a> in the <a data-link-type="biblio" href="#biblio-sai">Solid Application Interoperability Specification</a>.</p>
   <p>Load or initialize the two main grant types: <a data-link-type="dfn">Access Grant</a>, <a data-link-type="dfn">Access Invitation</a></p>
   <ul>
    <li data-md>
     <p><a href="#grants-loadgrant">§ 5.5 Load Grant</a> - Load an existing <a data-link-type="dfn">Access Grant</a> from an <a data-link-type="dfn">Access Grant Registry</a></p>
    <li data-md>
     <p><a href="#grants-loadinvitation">§ 5.6 Load Invitation</a> - Load an existing <a data-link-type="dfn">Access Invitation</a> from an <a data-link-type="dfn">Access Grant Registry</a></p>
    <li data-md>
     <p><a href="#grants-initializegrant">§ 5.1 Initialize Grant</a> - Initializes a new <a data-link-type="dfn">Access Grant</a> for a given <a data-link-type="dfn">Access Grant Subject</a> with one or more <a data-link-type="dfn">Access Need Groups</a></p>
    <li data-md>
     <p><a href="#grants-initializeinvitation">§ 5.2 Initialize Invitation</a> - Initializes a new <a data-link-type="dfn">Access Invitation</a> for one or more <a data-link-type="dfn">Access Invitation Channels</a> with one or more <a data-link-type="dfn">Access Need Groups</a></p>
   </ul>
   <p>Each <a data-link-type="dfn">Access Grant</a> or <a data-link-type="dfn">Access Invitation</a> will have some combination
of <a data-link-type="dfn">Data Grants</a>, and/or <a data-link-type="dfn">Trusted Grants</a>:</p>
   <ul>
    <li data-md>
     <p><a href="#grants-initializedatagrant">§ 5.3 Initialize Data Grant</a> - Initialize a <a data-link-type="dfn">Data Grant</a> as part
of <a data-link-type="dfn">Access Grant</a> initialization</p>
    <li data-md>
     <p><a href="#grants-initializetrustedgrant">§ 5.4 Initialize Trusted Grant</a> - Initialize a <a data-link-type="dfn">Trusted Grant</a> as part
of <a data-link-type="dfn">Access Grant</a> initialization</p>
   </ul>
   <p>Record <a data-link-type="dfn">Access Grants</a> and <a data-link-type="dfn">Access Invitations</a>:</p>
   <ul>
    <li data-md>
     <p><a href="#grants-recordgrant">§ 5.7 Record Grant</a> - Store a new or updated <a data-link-type="dfn">Access Grant</a> in an <a data-link-type="dfn">Access Grant Registry</a></p>
    <li data-md>
     <p><a href="#grants-recordinvitation">§ 5.8 Record Invitation</a> - Store a new or updated <a data-link-type="dfn">Access Invitation</a> in an <a data-link-type="dfn">Access Grant Registry</a></p>
   </ul>
   <p>Apply permissions based on the composition of an <a data-link-type="dfn">Access Grant</a>:</p>
   <ul>
    <li data-md>
     <p><a href="#apply-permissions">§ 5.11 Apply Permissions</a> - Apply permissions for an input <a data-link-type="dfn">Access Grant</a></p>
     <ul>
      <li data-md>
       <p><a href="#apply-data-permissions">§ 5.12 Apply Data Permissions</a> - Apply permissions for <a data-link-type="dfn">Data Grants</a></p>
      <li data-md>
       <p><a href="#apply-data-registration-permissions">§ 5.13 Apply Data Registration Permissions</a> - Apply permissions for a <a data-link-type="dfn">Data Registration</a></p>
      <li data-md>
       <p><a href="#apply-trusted-permissions">§ 5.15 Apply Trusted Permissions</a> - Apply permissions for <a data-link-type="dfn">Trusted Grants</a></p>
      <li data-md>
       <p><a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> - Apply permissions on a given resource for
a given <a data-link-type="dfn">Access Grant Subject</a></p>
      <li data-md>
       <p><a href="#apply-conditional-permissions">§ 5.17 Apply Conditional Resource Permissions</a> - Apply permissions on a given resource
for a given <a data-link-type="dfn">Access Grant Subject</a>, condiioned upon a graph relationship</p>
      <li data-md>
       <p><a href="#remove-resource-permissions">§ 5.18 Remove Resource Permissions</a> - Remove permissions on a given resource
for a given <a data-link-type="dfn">Access Grant Subject</a></p>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="5.1" id="grants-initializegrant"><span class="secno">5.1. </span><span class="content">Initialize Grant</span><a class="self-link" href="#grants-initializegrant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Initialize an <a data-link-type="dfn">Access Grant</a> by processing
        the input <a data-link-type="dfn">Access Need Groups</a> and
        then initializing <a data-link-type="dfn">Data Grants</a>,
        and/or <a data-link-type="dfn">Trusted Grants</a> with no access (yet). 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>SUBJECT</code>
      <td>The <a data-link-type="dfn">Access Grant Subject</a> that the <a data-link-type="dfn">Access Grant</a> is related to
     <tr>
      <td><code>GROUPS</code>
      <td><a data-link-type="dfn">Access Need Groups</a> to associate with the <a data-link-type="dfn">Access Grant</a>
     <tr>
      <td><code>LANG</code>
      <td>The <a data-link-type="dfn">Social Agent’s</a> preferred language
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Grant</a>
      <td>Newly initialized for the <a data-link-type="dfn">Access Grant Subject</a>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>GRANT</code> be a newly initialized <a data-link-type="dfn">Access Grant</a></p>
     <li data-md>
      <p>Let <code>GRANT hasAccessGrantSubject</code> be <code>SUBJECT</code></p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Need Group</a> <code>GROUP</code> in <code>GROUPS</code></p>
      <ol>
       <li data-md>
        <p>Link <code>GROUP</code> to <code>GRANT</code> via <code>GRANT hasAccessNeedGroup</code></p>
      </ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Need Group</a> <code>GROUP</code> linked via <code>GRANT hasAccessNeedGroup</code></p>
      <ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Access Need</a> <code>NEED</code> in <code>GROUP</code></p>
        <ol>
         <li data-md>
          <p>Call <a href="#grants-initializedatagrant">§ 5.3 Initialize Data Grant</a> with inputs: <code>NEED</code></p>
        </ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Trusted Need</a> <code>TNEED</code> in <code>GROUP</code></p>
        <ol>
         <li data-md>
          <p>Call <a href="#grants-initializetrustedgrant">§ 5.4 Initialize Trusted Grant</a> with inputs: <code>TNEED</code></p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <code>GRANT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.2" id="grants-initializeinvitation"><span class="secno">5.2. </span><span class="content">Initialize Invitation</span><a class="self-link" href="#grants-initializeinvitation"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Initialize an <a data-link-type="dfn">Access Invitation</a> by processing
        the input <a data-link-type="dfn">Access Need Groups</a> and
        then initializing <a data-link-type="dfn">Data Grants</a>, 
        or <a data-link-type="dfn">Trusted Grants</a> with no access (yet). 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>ICHANNELS</code>
      <td>A set of <a data-link-type="dfn">Access Invitation Channels</a>
     <tr>
      <td><code>GROUPS</code>
      <td><a data-link-type="dfn">Access Need Groups</a> to associate with the <a data-link-type="dfn">Access Invitation</a>
     <tr>
      <td><code>LANG</code>
      <td>The <a data-link-type="dfn">Social Agent’s</a> preferred language
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Invitation</a>
      <td>Newly initialized based on input <a data-link-type="dfn">Access Invitation Channels</a>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>INVITE</code> be a newly initialized <a data-link-type="dfn">Access Invitation</a></p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Invitation Channel</a> <code>ICHANNEL</code> in <code>ICHANNELS</code></p>
      <ol>
       <li data-md>
        <p>Let <code>ICHANNEL</code> be linked to <code>INVITE</code> via <code>INVITE hasAccessInvitationChannel</code></p>
      </ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Need Group</a> <code>GROUP</code> in <code>GROUPS</code></p>
      <ol>
       <li data-md>
        <p>Link <code>GROUP</code> to <code>INVITE</code> via <code>INVITE hasAccessNeedGroup</code></p>
      </ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Need Group</a> <code>GROUP</code> linked via <code>INVITE hasAccessNeedGroup</code></p>
      <ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Access Need</a> <code>NEED</code> in <code>GROUP</code></p>
        <ol>
         <li data-md>
          <p>Call <a href="#grants-initializedatagrant">§ 5.3 Initialize Data Grant</a> with inputs: <code>NEED</code>, <code>GRANT</code></p>
        </ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Trusted Need</a> <code>TNEED</code> in <code>GROUP</code></p>
        <ol>
         <li data-md>
          <p>Call <a href="#grants-initializetrustedgrant">§ 5.4 Initialize Trusted Grant</a> with inputs: <code>TNEED</code>, <code>GRANT</code></p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <code>INVITE</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.3" id="grants-initializedatagrant"><span class="secno">5.3. </span><span class="content">Initialize Data Grant</span><a class="self-link" href="#grants-initializedatagrant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        Initialize a <a data-link-type="dfn">Data Grant</a> and link it to the provided <a data-link-type="dfn">Access Need</a> <code>NEED</code>. 
       <p>Initialize inheriting <a data-link-type="dfn">Data Grants</a> if the <a data-link-type="dfn">Access Need</a> <code>NEED</code> has any inheriting <a data-link-type="dfn">Access Needs</a>.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>NEED</code>
      <td>An <a data-link-type="dfn">Access Need</a>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> that the <a data-link-type="dfn">Data Grant</a> will be linked to
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Data Grant</a>
      <td>Initialized <a data-link-type="dfn">Data Grant</a> corresponding to <code>NEED</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>DG</code> be a newly initialized <a data-link-type="dfn">Data Grant</a></p>
     <li data-md>
      <p>Let <code>DG hasAccessGrant</code> be <code>GRANT</code></p>
     <li data-md>
      <p>Let <code>DG satisfiesAccessNeed</code> be <code>NEED</code></p>
     <li data-md>
      <p>Let <code>DG registeredShapeTree</code> be <code>NEED registeredShapeTree</code></p>
     <li data-md>
      <p>Let <code>DG hasRegistration</code> be a <a data-link-type="dfn">Data Registration</a> <code>DR</code> where <code>DR registeredShapeTree</code> == <code>DG registeredShapeTree</code></p>
     <li data-md>
      <p>Let <code>DG accessmode</code>s be <code>CACCESS accessmode</code>s</p>
     <li data-md>
      <p>Let <code>DG scopeOGrant</code> be <code>interop:NoAccess</code></p>
     <li data-md>
      <p>Let <code>NEED hasDataGrant</code> be <code>DG</code></p>
     <li data-md>
      <p>For each inheriting <a data-link-type="dfn">Access Need</a> <code>INEED</code> linked
via <code>INEED inheritsFromNeed</code></p>
      <ol>
       <li data-md>
        <p>Let <code>IDG</code> be a newly initialized <a data-link-type="dfn">Data Grant</a></p>
       <li data-md>
        <p>Let <code>IDG inheritsFromGrant</code> be <code>DG</code></p>
       <li data-md>
        <p>Let <code>IDG satisfiesAccessNeed</code> be <code>INEED</code></p>
       <li data-md>
        <p>Let <code>IDG registeredShapeTree</code> be <code>INEED registeredShapeTree</code></p>
       <li data-md>
        <p>Let <code>IDG hasRegistration</code> be a <a data-link-type="dfn">Data Registration</a> <code>DR</code> where <code>DR registeredShapeTree</code> == <code>IDG registeredShapeTree</code></p>
       <li data-md>
        <p>Let <code>IDG accessMode</code>s be <code>INEED accessMode</code>s</p>
       <li data-md>
        <p>Let <code>IDG creatorAccessMode</code>s be <code>INEED creatorAccessMode</code>s</p>
       <li data-md>
        <p>Let <code>IDG scopeOfGrant</code> be <code>interop:NoAccess</code></p>
       <li data-md>
        <p>Link <code>IDG</code> to <code>DG</code> via <code>IDG inheritsFromGrant</code></p>
      </ol>
     <li data-md>
      <p>Return <code>DG</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.4" id="grants-initializetrustedgrant"><span class="secno">5.4. </span><span class="content">Initialize Trusted Grant</span><a class="self-link" href="#grants-initializetrustedgrant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Initialize a <a data-link-type="dfn">Trusted Grant</a> and link it to the provided <a data-link-type="dfn">Trusted Need</a> <code>TNEED</code>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TNEED</code>
      <td>A <a data-link-type="dfn">Trusted Need</a>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> that the <a data-link-type="dfn">Trusted Grant</a> will be linked to
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Trusted Grant</a>
      <td>Initialized <a data-link-type="dfn">Trusted Grant</a> corresponding to <code>TNEED</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>TG</code> be a newly initialized <a data-link-type="dfn">Trusted Grant</a></p>
     <li data-md>
      <p>Let <code>TG hasAccessGrant</code> be <code>GRANT</code></p>
     <li data-md>
      <p>Let <code>TG satisfiesTrustedNeed</code> be <code>TNEED</code></p>
     <li data-md>
      <p>Let <code>TG trustedWith</code> be <code>interop:NoAccess</code></p>
     <li data-md>
      <p>Let <code>TG scopeOfGrant</code> be <code>interop:NoAccess</code></p>
     <li data-md>
      <p>Let <code>TG trustedWithType</code> be <code>TNEED trustedWithType</code></p>
     <li data-md>
      <p>Let <code>TG accessmode</code>s be <code>TNEED accessmode</code>s</p>
     <li data-md>
      <p>Let <code>TNEED hasTrustedGrant</code> be <code>TG</code></p>
     <li data-md>
      <p>Return <code>TG</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.5" id="grants-loadgrant"><span class="secno">5.5. </span><span class="content">Load Grant</span><a class="self-link" href="#grants-loadgrant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation will load an <a data-link-type="dfn">Access Grant</a> from a given <a data-link-type="dfn">Access Grant Registry</a> 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>SUBJECT</code>
      <td>An <a data-link-type="dfn">Access Grant Subject</a> to lookup
     <tr>
      <td><code>REGISTRY</code>
      <td>An <a data-link-type="dfn">Access Grant Registry</a> to search
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Grant</a>
      <td>Corresponding to <code>SUBJECT</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Grant</a> <code>GRANT</code> included in <code>REGISTRY hasRegistration</code></p>
      <ol>
       <li data-md>
        <p>return <code>GRANT</code> if <code>GRANT hasAccessGrantSubject</code> == <code>SUBJECT</code></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.6" id="grants-loadinvitation"><span class="secno">5.6. </span><span class="content">Load Invitation</span><a class="self-link" href="#grants-loadinvitation"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation will load an <a data-link-type="dfn">Access Invitation</a> from a
      given <a data-link-type="dfn">Access Grant Registry</a> 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TARGET</code>
      <td>An <code>interop:ChannelTarget</code> to match
     <tr>
      <td><code>CODE</code>
      <td>An optional <code>interop:channelCode</code> to match
     <tr>
      <td><code>REGISTRY</code>
      <td>An <a data-link-type="dfn">Access Grant Registry</a> to search
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Invitations</a>
      <td>Matching <code>TARGET</code> and (if provided) <code>CODE</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>INVITATIONS</code> be an empty set of <a data-link-type="dfn">Access Invitations</a></p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Invitation</a> <code>INVITATION</code> linked via <code>REGISTRY hasRegistration</code></p>
      <ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Access Invitation Channel</a> <code>ICHANNEL</code> linked via <code>INVITATION hasAccessInvitationChannel</code></p>
        <ol>
         <li data-md>
          <p>Next if <code>ICHANNEL channelTarget</code> != <code>TARGET</code></p>
         <li data-md>
          <p>Next if <code>CODE</code> is not empty and <code>ICHANNEL channelCode</code> != <code>CODE</code></p>
         <li data-md>
          <p>Add <code>INVITATION</code> to <code>INVITATIONS</code></p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <code>INVITATIONS</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.7" id="grants-recordgrant"><span class="secno">5.7. </span><span class="content">Record Grant</span><a class="self-link" href="#grants-recordgrant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation stores a new or updated <a data-link-type="dfn">Access Grant</a> in
      an <a data-link-type="dfn">Access Grant Registry</a>, applies permissions accordingly, and
      calls for an <a data-link-type="dfn">Access Receipt</a> to be provided. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td>An <a data-link-type="dfn">Access Grant</a> to store in <code>REGISTRY</code>
     <tr>
      <td><code>REGISTRY</code>
      <td>The <a data-link-type="dfn">Access Grant Registry</a> to store <code>GRANT</code> into
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Grant</a>
      <td>Stored in <code>REGISTRY</code> with permissions applied and <a data-link-type="dfn">Access Receipt</a> furnished
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Add or Update <code>GRANT</code> resource in the <code>REGISTRY</code> container, conforming to
the assigned <a href="interop.tree#AccessGrantTree">interopt:AccessGrantTree</a>.</p>
     <li data-md>
      <p>Link <code>GRANT</code> to the <code>REGISTRY</code> via <code>REGISTRY hasRegistration</code> if
    it has not already been added</p>
     <li data-md>
      <p>Call <a href="#apply-permissions">§ 5.11 Apply Permissions</a> with inputs: <code>GRANT</code></p>
     <li data-md>
      <p>Call <a href="https://solid.github.io/data-interoperability-panel/specification/#provide-access-receipt">Solid Application Interoperability § provide-access-receipt</a> with inputs: <code>GRANT</code></p>
     <li data-md>
      <p>Return <code>GRANT</code></p>
    </ol>
   </div>
   <p class="issue" id="issue-4a203aca"><a class="self-link" href="#issue-4a203aca"></a> Need to properly factor in multi-pod scenarios. Must identify the
proper access registry to store things in based on the data registration, which
means pods will also need to be registered.</p>
   <h3 class="heading settled" data-level="5.8" id="grants-recordinvitation"><span class="secno">5.8. </span><span class="content">Record Invitation</span><a class="self-link" href="#grants-recordinvitation"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation stores a new or updated <a data-link-type="dfn">Access Invitation</a> in
      an <a data-link-type="dfn">Access Grant Registry</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>INVITATION</code>
      <td>An <a data-link-type="dfn">Access Invitation</a>
     <tr>
      <td><code>REGISTRY</code>
      <td>An <a data-link-type="dfn">Access Grant Registry</a>
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Invitation</a>
      <td>Stored in <code>REGISTRY</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Add or Update <code>INVITATION</code> resource in the <code>REGISTRY</code> container, conforming to
the assigned <a href="interop.tree#AccessInvitationTree">interopt:AccessInvitationTree</a></p>
     <li data-md>
      <p>Link <code>INVITATION</code> to the <code>REGISTRY</code> via <code>ACCESS hasRegistration</code> if
    it has not already been added</p>
     <li data-md>
      <p>Call <a href="#grants-deliverinvitation">§ 5.9 Deliver Invitation</a> with inputs: <code>INVITATION</code></p>
     <li data-md>
      <p>Return <code>INVITATION</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.9" id="grants-deliverinvitation"><span class="secno">5.9. </span><span class="content">Deliver Invitation</span><a class="self-link" href="#grants-deliverinvitation"></a></h3>
   <p class="issue" id="issue-2800f864"><a class="self-link" href="#issue-2800f864"></a> Write standard operation for invitation delivery</p>
   <h3 class="heading settled" data-level="5.10" id="grants-validateinvitation"><span class="secno">5.10. </span><span class="content">Validate Invitation</span><a class="self-link" href="#grants-validateinvitation"></a></h3>
   <p class="issue" id="issue-00444ef2"><a class="self-link" href="#issue-00444ef2"></a> Write standard operation for validating an invitation</p>
   <h3 class="heading settled" data-level="5.11" id="apply-permissions"><span class="secno">5.11. </span><span class="content">Apply Permissions</span><a class="self-link" href="#apply-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation takes a validated <a data-link-type="dfn">Access Grant</a> <code>GRANT</code> associated with a given <a data-link-type="dfn">Access Grant Subject</a> and
      applies the permissions accordingly based on the <a data-link-type="dfn">Data Grants</a> and/or <a data-link-type="dfn">Trusted Grants</a> associated with the <a data-link-type="dfn">Access Grant</a>. It applies to both new and updated <a data-link-type="dfn">Access Grants</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> to apply permissions for
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Grant</a>
      <td>That has had the relevant permissions applied
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Call <a href="#apply-data-permissions">§ 5.12 Apply Data Permissions</a> with inputs: <code>GRANT</code></p>
     <li data-md>
      <p>Call <a href="#apply-trusted-permissions">§ 5.15 Apply Trusted Permissions</a> with inputs: <code>GRANT</code></p>
     <li data-md>
      <p>Return <code>GRANT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.12" id="apply-data-permissions"><span class="secno">5.12. </span><span class="content">Apply Data Permissions</span><a class="self-link" href="#apply-data-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This operation applies data permissions for a new or updated <a data-link-type="dfn">Access Grant</a>. 
       <p>It iterates over each <a data-link-type="dfn">Data Grant</a> linked via <code>GRANT hasDataGrant</code>.</p>
       <p>All <a data-link-type="dfn">Data Grants</a> are added to
      a hash map <code>DRHASH</code>. The key is the <a data-link-type="dfn">Data Registration</a> associated
      with each <a data-link-type="dfn">Data Grant</a> <code>hasDataRegistration</code>.</p>
       <p>The end result is the keys of <code>DRHASH</code> are a unique
      set of <a data-link-type="dfn">Data Registrations</a> affected by <code>GRANT</code>, and each key
      has an array of related <a data-link-type="dfn">Data Grants</a> as its value.</p>
       <p>Each <a data-link-type="dfn">Data Registration</a> and the array of grants that affect it
      are then passed to <a href="#apply-data-registration-permissions">§ 5.13 Apply Data Registration Permissions</a>.</p>
       <figure id="fig-drhash"> <img src="diagrams/apply-data-permissions-drhash.svg" width="100%/"> </figure>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> to apply permissions for
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Grant</a>
      <td>That has had the relevant permissions applied
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>DRHASH</code> be an empty hash map where a <a data-link-type="dfn">Data Registration</a> is key and
the value is an array of <a data-link-type="dfn">Data Grants</a>.</p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Data Grant</a> <code>DG</code> linked via <code>GRANT hasDataGrant</code></p>
      <ol>
       <li data-md>
        <p>Let <code>DRKEY</code> be <code>DG hasDataRegistration</code> added or found in <code>DRHASH</code></p>
       <li data-md>
        <p>Add <code>DG</code> to the value array for <code>DRKEY</code> if missing</p>
      </ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Data Registration</a> <code>DR</code> in <code>DRHASH</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#apply-data-registration-permissions">§ 5.13 Apply Data Registration Permissions</a> with inputs: <code>DR</code>, <code>DRHASH[DR]</code>, <code>GRANT</code></p>
      </ol>
     <li data-md>
      <p>Return <code>GRANT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.13" id="apply-data-registration-permissions"><span class="secno">5.13. </span><span class="content">Apply Data Registration Permissions</span><a class="self-link" href="#apply-data-registration-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
       <p>This operation applies permissions for a given <a data-link-type="dfn">Data Registration</a>,
      based on the <a data-link-type="dfn">Data Grants</a> that have been assigned to it
      from the input <a data-link-type="dfn">Access Grant</a>.</p>
       <p>Before assigning permissions, any existing permissions for the <a data-link-type="dfn">Access Grant Subject</a> are cleared. This operation does a full
      scan for simplicity, but optimization is recommended.</p>
       <p>All of the grants are iterated, and organized into a hash map
      with data-specific <code>interop:scopeOfGrant</code> values as keys. Each <a data-link-type="dfn">Data Grant</a> with that scope will update the associated value.</p>
       <ul>
        <li data-md>
         <p><code>interop:AllInstances</code> - An array of <code>interop:accessMode</code> values</p>
        <li data-md>
         <p><code>interop:SelectedInstances</code> - A hash map with <a data-link-type="dfn">Data Instance</a> as
  key and an array of <code>interop:accessMode</code> values</p>
        <li data-md>
         <p><code>interop:InheritInstances</code> - A hash map with the parent <a data-link-type="dfn">Data Instance</a> as key and an array of <code>interop:accessMode</code> values</p>
        <li data-md>
         <p><code>interop:NoAccess</code> - Boolean <code>true</code> or <code>false</code></p>
       </ul>
       <figure id="fig-data-scopehash"> <img src="diagrams/apply-data-permissions-scopehash.svg" width="100%/"> </figure>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>DR</code>
      <td>A <a data-link-type="dfn">Data Registration</a>
     <tr>
      <td><code>DATAGRANTS</code>
      <td>An array of <a data-link-type="dfn">Data Grants</a> associated with the <a data-link-type="dfn">Data Registration</a> in <code>GRANT</code>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> that permissions are being applied for
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Data Registration</a>
      <td>That has had the relevant permissions applied
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>SUBJECT</code> be the <a data-link-type="dfn">Access Grant Subject</a> linked via <code>GRANT hasAccessGrantSubject</code></p>
     <li data-md>
      <p>Call <a href="#remove-resource-permissions">§ 5.18 Remove Resource Permissions</a> with inputs: <code>DR</code>, <code>SUBJECT</code></p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Data Instance</a> <code>DI</code> linked via <code>DR ldp:hasMember</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#remove-resource-permissions">§ 5.18 Remove Resource Permissions</a> with inputs: <code>DI</code>, <code>SUBJECT</code></p>
      </ol>
     <li data-md>
      <p>Let <code>SCOPEHASH</code> be a hash map with keys: <code>interop:AllInstances</code>, <code>interop:SelectedInstances</code>, <code>interop:InheritInstances</code>, <code>interop:NoAccess</code></p>
     <li data-md>
      <p>Let <code>SCOPEHASH[interop:SelectedInstances]</code> be an empty hash map where <a data-link-type="dfn">Data Instances</a> are keys with an array of <code>interop:AccessMode</code>s as values</p>
     <li data-md>
      <p>Let <code>SCOPEHASH[interop:InheritInstances]</code> be an empty hash map where
parent <a data-link-type="dfn">Data Instances</a> are keys with an array of <code>interop:AccessMode</code>s as values</p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Data Grant</a> <code>DATAGRANT</code> in <code>DATAGRANTS</code></p>
      <ol>
       <li data-md>
        <p>If <code>DATAGRANT scopeOfGrant</code> is <code>interop:AllInstances</code></p>
        <ol>
         <li data-md>
          <p>Let <code>SCOPEHASH[interop:AllInstances]</code> value be a union of current <a data-link-type="dfn">access modes</a> and <code>DATAGRANT accessMode</code>s</p>
        </ol>
       <li data-md>
        <p>If <code>DATAGRANT scopeOfGrant</code> is <code>interop:NoAccess</code></p>
        <ol>
         <li data-md>
          <p>Let <code>SCOPEHASH[interop:NoAccess]</code> value be <code>true</code></p>
        </ol>
       <li data-md>
        <p>If <code>DATAGRANT scopeOfGrant</code> is <code>interop:SelectedInstances</code></p>
        <ol>
         <li data-md>
          <p>For each <a data-link-type="dfn">Data Instance</a> <code>DI</code> linked via <code>DATAGRANT hasDataInstance</code></p>
          <ol>
           <li data-md>
            <p>Let <code>INSTKEY</code> be <a data-link-type="dfn">Data Instance</a> <code>DI</code> added or found in <code>SCOPEHASH[interop:SelectedInstances][DI]</code></p>
           <li data-md>
            <p>Let <code>SCOPEHASH[interop:SelectedInstances][DI]</code> value be a union of current <a data-link-type="dfn">access modes</a> and <code>DATAGRANT accessMode</code>s</p>
          </ol>
        </ol>
       <li data-md>
        <p>If <code>DATAGRANT scopeOfGrant</code> is <code>interop:InheritInstances</code></p>
        <ol>
         <li data-md>
          <p>Let <code>PDG</code> be the parent <a data-link-type="dfn">Data Grant</a> linked via <code>DATAGRANT inheritsFromGrant</code> that the <a data-link-type="dfn">Data Grant</a> inherits from.</p>
         <li data-md>
          <p>Error if <code>PDG scopeOfGrant</code> is not <code>interop:SelectedInstances</code></p>
         <li data-md>
          <p>For each <a data-link-type="dfn">Data Instance</a> <code>DI</code> linked via <code>PDG hasDataInstance</code></p>
          <ol>
           <li data-md>
            <p>Let <code>INSTKEY</code> be <a data-link-type="dfn">Data Instance</a> <code>DI</code> added or found in <code>SCOPEHASH[interop:InheritInstances][DI]</code></p>
           <li data-md>
            <p>Let <code>SCOPEHASH[interop:InheritInstances][DI]</code> value be a union of current <a data-link-type="dfn">access modes</a> and <code>DATAGRANT accessMode</code>s</p>
          </ol>
        </ol>
      </ol>
     <li data-md>
      <p>If <code>SCOPEHASH[interop:AllInstances]</code> is not empty</p>
      <ol>
       <li data-md>
        <p>Call <a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> with inputs: <code>DR</code>, <code>SUBJECT</code>, <code>MODES</code></p>
      </ol>
     <li data-md>
      <p>If <code>SCOPEHASH[interop:InheritInstances]</code> is not empty</p>
      <ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Data Instance</a> <code>DI</code> in <code>SCOPEHASH[interop:InheritInstances]</code></p>
       <li data-md>
        <p>Let <code>REF</code> be the <a data-link-type="dfn">Shape Tree Reference</a> from
  calling <a href="#get-shape-tree-reference">§ 5.14 Get Shape Tree Reference</a> with inputs: <code>DR registeredShapeTree</code>, <code>DI registeredShapeTree</code></p>
       <li data-md>
        <p>Let <code>PRED</code> be the rdf:Property extracted from <code>REF traverseViaShapePath</code></p>
       <li data-md>
        <p>Call <a href="#apply-conditional-permissions">§ 5.17 Apply Conditional Resource Permissions</a> with inputs: <code>DR</code>, <code>SUBJECT</code>, <code>MODES</code>, <code>DI</code>, <code>PRED</code>, <code>NULL</code></p>
      </ol>
     <li data-md>
      <p>If <code>SCOPEHASH[interop:SelectedInstances]</code> is not empty</p>
      <ol>
       <li data-md>
        <p>For each <a data-link-type="dfn">Data Instance</a> <code>DI</code> in <code>SCOPEHASH[interop:SelectedInstances]</code></p>
        <ol>
         <li data-md>
          <p>Call <a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> with inputs: <code>SCOPEHASH[interop:SelectedInstances][DI]</code>, <code>SUBJECT</code>, <code>MODES</code></p>
        </ol>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.14" id="get-shape-tree-reference"><span class="secno">5.14. </span><span class="content">Get Shape Tree Reference</span><a class="self-link" href="#get-shape-tree-reference"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This option will return a <a data-link-type="dfn">Shape Tree Reference</a> between
      a <a data-link-type="dfn">shape tree</a> <code>REFERENCED</code> and a <a data-link-type="dfn">shape tree</a> <code>REFERENCEDBY</code> 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>REFERENCED</code>
      <td>The referenced <a data-link-type="dfn">shape tree</a>
     <tr>
      <td><code>REFERENCEDBY</code>
      <td>The <a data-link-type="dfn">shape tree</a> that <code>REFERENCED</code> is referenced by
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Shape Tree Reference</a>
      <td>Linking <code>REFERENCEDBY</code> to <code>REFERENCED</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Shape Tree Reference</a> <code>REF</code> linked via <code>REFERENCEDBY st:references</code></p>
      <ol>
       <li data-md>
        <p>Return <code>REF</code> if <code>REF hasShapeTree</code> is <code>REFERENCED</code></p>
      </ol>
     <li data-md>
      <p>Error because no <a data-link-type="dfn">Shape Tree Reference</a> was found for <code>REFERENCED</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.15" id="apply-trusted-permissions"><span class="secno">5.15. </span><span class="content">Apply Trusted Permissions</span><a class="self-link" href="#apply-trusted-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation applies permissions for a given <a data-link-type="dfn">Trusted Grant</a>. It applies
      to both new and updated <a data-link-type="dfn">Trusted Grants</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TGRANT</code>
      <td>A validated <a data-link-type="dfn">Trusted Grant</a>
     <tr>
      <td><code>GRANT</code>
      <td>The validated <a data-link-type="dfn">Access Grant</a> that <code>TGRANT</code> belongs to
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Trusted Grant</a>
      <td>That has had the relevant permissions applied
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>SUBJECT</code> be the <a data-link-type="dfn">Access Grant Subject</a> <code>GRANT hasAccessGrantSubject</code></p>
     <li data-md>
      <p>For each <a data-link-type="dfn">Trusted Grant</a> <code>TGRANT</code> linked via <code>GRANT hasTrustedGrant</code></p>
      <ol>
       <li data-md>
        <p>Let <code>MODES</code> be the <a data-link-type="dfn">access modes</a> linked via <code>TGRANT accessMode</code></p>
       <li data-md>
        <p>If <code>TGRANT trustedWithType</code> is <code>interop:Agent</code></p>
        <ol>
         <li data-md>
          <p>Let <code>PROFILE</code> be <code>TGRANT trustedWith</code></p>
         <li data-md>
          <p>Call <a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> with inputs: <code>PROFILE</code>, <code>SUBJECT</code>, <code>MODES</code></p>
        </ol>
       <li data-md>
        <p>If <code>TGRANT trustedWithType</code> is <code>interop:RegistrySet</code></p>
        <ol>
         <li data-md>
          <p>Let <code>SET</code> be <code>TGRANT trustedWith</code></p>
         <li data-md>
          <p>Let <code>REGISTRIES</code> be the <a data-link-type="dfn">Registries</a> linked via <code>SET hasRegistry</code></p>
         <li data-md>
          <p>Call <a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> with inputs: <code>SET</code>, <code>SUBJECT</code>, <code>MODES</code></p>
         <li data-md>
          <p>For each <a data-link-type="dfn">Registry</a> <code>REGISTRY</code> in <code>REGISTRIES</code></p>
          <ol>
           <li data-md>
            <p>Call <a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> with inputs: <code>REGISTRY</code>, <code>SUBJECT</code>, <code>MODES</code></p>
          </ol>
        </ol>
       <li data-md>
        <p>If <code>TGRANT trustedWithType</code> is <code>interop:Registry</code></p>
        <ol>
         <li data-md>
          <p>Let <code>REGISTRY</code> be <code>TGRANT trustedWith</code></p>
         <li data-md>
          <p>Call <a href="#apply-resource-permissions">§ 5.16 Apply Resource Permissions</a> with inputs: <code>REGISTRY</code>, <code>SUBJECT</code>, <code>MODES</code></p>
        </ol>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.16" id="apply-resource-permissions"><span class="secno">5.16. </span><span class="content">Apply Resource Permissions</span><a class="self-link" href="#apply-resource-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation applies permissions on a given resource for a given <a data-link-type="dfn">Access Grant Subject</a>. It clears any existing permissions for
      the <a data-link-type="dfn">Access Grant Subject</a> first, so that the resultant permissions
      are exactly the ones requested. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>RESOURCE</code>
      <td>Resource whose permissions will be changed
     <tr>
      <td><code>SUBJECT</code>
      <td>The <a data-link-type="dfn">Access Grant Subject</a> who the permissions apply to
     <tr>
      <td><code>MODES</code>
      <td>A list of access modes to apply to the resource
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td>Boolean
      <td>Success or Failure
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Call <a href="#remove-resource-permissions">§ 5.18 Remove Resource Permissions</a> with inputs: <code>RESOURCE</code>, <code>SUBJECT</code></p>
     <li data-md>
      <p>Add a new <a data-link-type="dfn">Authorization Statement</a> <code>NEWSTATEMENT</code> to <code>ACL</code></p>
     <li data-md>
      <p>Set <code>NEWSTATEMENT</code> <a data-link-type="dfn">Access Grant Subject</a> to <code>SUBJECT</code>.</p>
     <li data-md>
      <p>Set the <a data-link-type="dfn">access modes</a> for <code>NEWSTATEMENT</code> to <code>MODES</code></p>
     <li data-md>
      <p>If <code>RESOURCE</code> is a container</p>
      <ol>
       <li data-md>
        <p>Set all members of <code>RESOURCE</code> to inherit the same permissions</p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.17" id="apply-conditional-permissions"><span class="secno">5.17. </span><span class="content">Apply Conditional Resource Permissions</span><a class="self-link" href="#apply-conditional-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
        This operation applies permissions on a given resource for a given <a data-link-type="dfn">Access Grant Subject</a>. Those permissions are conditioned upon the
      existence of a graph link between a node in the resource and another node
      in another resource on the same pod. 
       <p>It clears any existing permissions for
      the <a data-link-type="dfn">Access Grant Subject</a> first, so that the resultant permissions
      are exactly the ones requested.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>RESOURCE</code>
      <td>Resource whose permissions will be changed
     <tr>
      <td><code>SUBJECT</code>
      <td>The <a data-link-type="dfn">Access Grant Subject</a> who the permissions apply to
     <tr>
      <td><code>MODES</code>
      <td>A list of access modes to apply to the resource
     <tr>
      <td><code>CONDSUB</code>
      <td>Subject of conditional link
     <tr>
      <td><code>CONDPRED</code>
      <td>Predicate for conditional link
     <tr>
      <td><code>CONDOBJ</code>
      <td>Object for conditional link
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td>Boolean
      <td>Success or Failure
   </table>
   <p class="issue" id="issue-8ac7ce01"><a class="self-link" href="#issue-8ac7ce01"></a> Need to determine how to deal with objects that are
dynamic, where we need to match against more than one resource and
the subject identifier could? vary</p>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Call <a href="#remove-resource-permissions">§ 5.18 Remove Resource Permissions</a> with inputs: <code>RESOURCE</code>, <code>SUBJECT</code></p>
     <li data-md>
      <p>Add a new <a data-link-type="dfn">Authorization Statement</a> <code>NEWSTATEMENT</code> to <code>ACL</code></p>
     <li data-md>
      <p>Set <code>NEWSTATEMENT</code> <a data-link-type="dfn">Access Grant Subject</a> to <code>SUBJECT</code></p>
     <li data-md>
      <p>Set a condition on <code>NEWSTATEMENT</code> that access is only permitted when
a graph link is present composed of
subject: <code>CONDSUB</code>, predicate: <code>CONDPRED</code>, object: <code>CONDOBJ</code></p>
     <li data-md>
      <p>Set the <a data-link-type="dfn">access modes</a> for <code>NEWSTATEMENT</code> to <code>MODES</code></p>
     <li data-md>
      <p>If <code>RESOURCE</code> is a container</p>
      <ol>
       <li data-md>
        <p>Set all members of <code>RESOURCE</code> to inherit the same permissions</p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.18" id="remove-resource-permissions"><span class="secno">5.18. </span><span class="content">Remove Resource Permissions</span><a class="self-link" href="#remove-resource-permissions"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation removes permissions on a given resource for a given <a data-link-type="dfn">Access Grant Subject</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>RESOURCE</code>
      <td>Resource whose permissions will be changed
     <tr>
      <td><code>SUBJECT</code>
      <td>The <a data-link-type="dfn">Access Grant Subject</a> who the permissions apply to
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td>Boolean
      <td>Success or Failure
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>ACL</code> be the <a data-link-type="dfn">ACL Resource</a> directly associated with <code>RESOURCE</code></p>
     <li data-md>
      <p>Let <code>STATEMENTS</code> be any <a data-link-type="dfn">Authorization Statements</a> in <code>ACL</code> directly
associated with <code>SUBJECT</code>.</p>
     <li data-md>
      <p>For each <code>STATEMENT</code> in <code>STATEMENTS</code></p>
      <ol>
       <li data-md>
        <p>Remove <a data-link-type="dfn">Access Grant Subject</a> from <code>STATEMENT</code></p>
       <li data-md>
        <p>Remove <code>STATEMENT</code> if there are no remaining <a data-link-type="dfn">Access Grant Subjects</a></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.19" id="deny-access-need-group"><span class="secno">5.19. </span><span class="content">Deny Access Need Group</span><a class="self-link" href="#deny-access-need-group"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation is used when a given <a data-link-type="dfn">Access Need Group</a> with
      optional necessity has been denied. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td>An <a data-link-type="dfn">Access Grant</a>
     <tr>
      <td><code>GROUP</code>
      <td>An <a data-link-type="dfn">Access Need Group</a>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Need</a> <code>NEED</code> in <code>GROUP</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#deny-data-grant">§ 5.20 Deny Data Grant</a> with inputs: <code>NEED hasDataGrant</code>, <code>GRANT</code></p>
      </ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Trusted Need</a> <code>TNEED</code> in <code>GROUP</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#deny-trusted-grant">§ 5.28 Deny Trusted Grant</a> with inputs: <code>NEED hasTrustedGrant</code>, <code>GRANT</code></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.20" id="deny-data-grant"><span class="secno">5.20. </span><span class="content">Deny Data Grant</span><a class="self-link" href="#deny-data-grant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation is used when a given <a data-link-type="dfn">Data Grant</a> has been denied. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>DG</code>
      <td>A <a data-link-type="dfn">Data Grant</a>
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>DG</code> is linked to
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>DG scopeOfGrant</code> be <code>interop:NoAccess</code></p>
     <li data-md>
      <p>For each inheriting <a data-link-type="dfn">Data Grant</a> <code>IDG</code> linked via <code>IDG inheritsFromGrant</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#deny-data-grant">§ 5.20 Deny Data Grant</a> with inputs: <code>IDG</code>, <code>GRANT</code></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.21" id="select-all-data-instances"><span class="secno">5.21. </span><span class="content">Select All Data Instances</span><a class="self-link" href="#select-all-data-instances"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to select all <a data-link-type="dfn">Data Instances</a> for a given <a data-link-type="dfn">Data Grant</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>DG</code>
      <td>The <a data-link-type="dfn">Data Grant</a>
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>DATAGRANT</code> is associated with
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>DG scopeOfGrant</code> be <code>interop:AllInstances</code></p>
     <li data-md>
      <p>Remove all links for <code>DG hasDataInstance</code></p>
     <li data-md>
      <p>For each inheriting <a data-link-type="dfn">Data Grant</a> <code>IDG</code> linked via <code>IDG inheritsFromGrant</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#select-all-inherited-data-instances">§ 5.22 Select All Inherited Data Instances</a> with inputs: <code>IDG</code></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.22" id="select-all-inherited-data-instances"><span class="secno">5.22. </span><span class="content">Select All Inherited Data Instances</span><a class="self-link" href="#select-all-inherited-data-instances"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to select all <a data-link-type="dfn">Data Instances</a> for a given inheriting <a data-link-type="dfn">Data Grant</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>IDG</code>
      <td>The inheriting <a data-link-type="dfn">Data Grant</a>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>IDG scopeOfGrant</code> be <code>interop:AllInstances</code></p>
     <li data-md>
      <p>Remove all links for <code>IDG hasDataInstance</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.23" id="select-data-instance"><span class="secno">5.23. </span><span class="content">Select Specific Data Instance</span><a class="self-link" href="#select-data-instance"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to select specific <a data-link-type="dfn">Data Instances</a> for a given <a data-link-type="dfn">Data Grant</a>. If the <a data-link-type="dfn">Data Grant</a> has inheriting <a data-link-type="dfn">Data Grants</a>,
      this will set their scope to <code>interop:InheritInstances</code>.
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>DI</code>
      <td>A <a data-link-type="dfn">Data Instance</a> selected for access
     <tr>
      <td><code>DG</code>
      <td>The <a data-link-type="dfn">Data Grant</a> that <code>DI</code> is associated with
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>DG</code> is associated with
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>DG scopeOfGrant</code> be <code>interop:SelectedInstances</code></p>
     <li data-md>
      <p>Let <code>DG hasDataInstance</code> be linked to one unique instance of <code>DI</code></p>
     <li data-md>
      <p>For each inheriting <a data-link-type="dfn">Data Grant</a> <code>IDG</code> linked via <code>IDG inheritsFromGrant</code></p>
      <ol>
       <li data-md>
        <p>Call <a href="#select-inherited-data-instance">§ 5.24 Select Inherited Data Instance</a> with inputs: <code>IDG</code></p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.24" id="select-inherited-data-instance"><span class="secno">5.24. </span><span class="content">Select Inherited Data Instance</span><a class="self-link" href="#select-inherited-data-instance"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to set the scope of a <a data-link-type="dfn">Data Grant</a> to inherited access. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>IDG</code>
      <td>The inheriting <a data-link-type="dfn">Data Grant</a> to adjust
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>IDG scopeOfGrant</code> be <code>interop:InheritInstances</code></p>
     <li data-md>
      <p>Remove all links via <code>IDG hasDataInstance</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.25" id="select-inherited-data-instance①"><span class="secno">5.25. </span><span class="content">Select Specific Inherited Data Instance</span><a class="self-link" href="#select-inherited-data-instance①"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to set the scope of a <a data-link-type="dfn">Data Grant</a> to inherited access. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>DI</code>
      <td>A <a data-link-type="dfn">Data Instance</a> selected for access
     <tr>
      <td><code>IDG</code>
      <td>The inheriting <a data-link-type="dfn">Data Grant</a> to adjust
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>IDG scopeOfGrant</code> be <code>interop:SelectedInstances</code></p>
     <li data-md>
      <p>Let <code>IDG hasDataInstance</code> be linked to one unique instance of <code>DI</code></p>
    </ol>
   </div>
   <p></p>
   <h3 class="heading settled" data-level="5.26" id="select-trusted-registry-set"><span class="secno">5.26. </span><span class="content">Select Trusted Registry Set</span><a class="self-link" href="#select-trusted-registry-set"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to select an entire <a data-link-type="dfn">Registry Set</a> of a given
      registry type for a <a data-link-type="dfn">Trusted Grant</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>SET</code>
      <td>The <a data-link-type="dfn">Registry Set</a> selected for access
     <tr>
      <td><code>TG</code>
      <td>The <a data-link-type="dfn">Trusted Grant</a> that <code>SET</code> is associated with
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>TG</code> is associated with
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>TG scopeOfGrant</code> be <code>interop:TrustedAccess</code></p>
     <li data-md>
      <p>Let <code>TG trustedWith</code> be <code>SET</code></p>
     <li data-md>
      <p>Let <code>TG trustedWithType</code> be <code>SET rdf:type</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.27" id="select-trusted-registry"><span class="secno">5.27. </span><span class="content">Select Specific Trusted Registry</span><a class="self-link" href="#select-trusted-registry"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> Used to select a specific <a data-link-type="dfn">Registry</a> of a given registry
      type for a <a data-link-type="dfn">Trusted Grant</a>. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>REG</code>
      <td>The <a data-link-type="dfn">Registry</a> selected for access
     <tr>
      <td><code>TG</code>
      <td>The <a data-link-type="dfn">Trusted Grant</a> that <code>REG</code> is associated with
     <tr>
      <td><code>GRANT</code>
      <td>The <a data-link-type="dfn">Access Grant</a> that <code>TG</code> is associated with
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>TG scopeOfGrant</code> be <code>interop:TrustedAccess</code></p>
     <li data-md>
      <p>Let <code>TG trustedWith</code> be <code>REG</code></p>
     <li data-md>
      <p>Let <code>TG trustedWithType</code> be <code>SET rdf:type</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.28" id="deny-trusted-grant"><span class="secno">5.28. </span><span class="content">Deny Trusted Grant</span><a class="self-link" href="#deny-trusted-grant"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2"> This operation is used when a given <a data-link-type="dfn">Trusted Grant</a> has been denied. 
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>TG</code>
      <td>A <a data-link-type="dfn">Trusted Grant</a>
     <tr>
      <td><code>GRANT</code>
      <td>An <a data-link-type="dfn">Access Grant</a>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>TG scopeOfGrant</code> be <code>interop:NoAccess</code></p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="6" id="receipts"><span class="secno">6. </span><span class="content">Access Receipts</span><a class="self-link" href="#receipts"></a></h2>
   <p>The following operations pertain to <a href="https://solid.github.io/data-interoperability-panel/specification/#receipts">Access Receipts</a> in the <a data-link-type="biblio" href="#biblio-sai">Solid Application Interoperability Specification</a>.</p>
   <h3 class="heading settled" data-level="6.1" id="provide-access-receipt"><span class="secno">6.1. </span><span class="content">Provide Access Receipt</span><a class="self-link" href="#provide-access-receipt"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
       <p>This operation takes an input <a data-link-type="dfn">Access Grant</a> and provides
      an <a data-link-type="dfn">Access Receipt</a> to the grantee. In the event that
      the grantee is an <a data-link-type="dfn">Application</a> it may provide the <a data-link-type="dfn">Access Receipt</a> in the <a data-link-type="dfn">Application Registration</a> for the <a data-link-type="dfn">Application</a>.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> to provide a receipt for
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Receipt</a>
      <td>that was provided for <code>GRANT</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>SUBJECT</code> be the <a data-link-type="dfn">Access Grant Subject</a> linked via <code>GRANT hasAccessGrantSubject</code></p>
     <li data-md>
      <p>Let <code>AGENT</code> be <code>SUBJECT accessByAgent</code></p>
     <li data-md>
      <p>Let <code>APP</code> be <code>SUBJECT accessByApplication</code></p>
     <li data-md>
      <p>If <code>APP</code> is not empty</p>
      <ol>
       <li data-md>
        <p>If <code>APP receivesAccessReceipt</code> is <code>interop:ReceiptInRegistration</code></p>
        <ol>
         <li data-md>
          <p>Let <code>RECEIPT</code> be result of <a href="#provide-receipt-in-registration">§ 6.2 Provide Receipt in Application Registration</a> with
inputs: <code>GRANT</code></p>
        </ol>
       <li data-md>
        <p>If <code>APP receivesAccessReceipt</code> is <code>interop:ReceiptInMessage</code></p>
        <ol>
         <li data-md>
          <p>Let <code>RECEIPT</code> be result of <a href="#provide-receipt-in-message">§ 6.3 Provide Receipt in Message</a> with
inputs: <code>GRANT</code></p>
        </ol>
      </ol>
     <li data-md>
      <p>If <code>APP</code> is empty and <code>AGENT</code> is not empty</p>
      <ol>
       <li data-md>
        <p>Return error if <code>AGENT receivesAccessReceipt</code> is not <code>interop:ReceiptInMessage</code></p>
       <li data-md>
        <p>Let <code>RECEIPT</code> be result of <a href="#provide-receipt-in-message">§ 6.3 Provide Receipt in Message</a> with inputs: <code>GRANT</code></p>
      </ol>
     <li data-md>
      <p>Return <code>RECEIPT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.2" id="provide-receipt-in-registration"><span class="secno">6.2. </span><span class="content">Provide Receipt in Application Registration</span><a class="self-link" href="#provide-receipt-in-registration"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
       <p>This operation provides an <a data-link-type="dfn">Access Receipt</a> for an <a data-link-type="dfn">Access Grant</a> in the <a data-link-type="dfn">Application Registration</a> of the <a data-link-type="dfn">Application</a> in
      the <a data-link-type="dfn">Access Grant Subject</a>.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> to provide a receipt for
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Receipt</a>
      <td>for <code>GRANT</code> stored in an <a data-link-type="dfn">Application Registration</a>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>RECEIPT</code> be an empty <a data-link-type="dfn">Access Receipt</a></p>
     <li data-md>
      <p>Let <code>SUBJECT</code> be the <a data-link-type="dfn">Access Grant Subject</a> linked via <code>GRANT hasAccessGrantSubject</code></p>
     <li data-md>
      <p>Let <code>GRANTOR</code> be the current <a data-link-type="dfn">Social Agent</a></p>
     <li data-md>
      <p>Let <code>OWNER</code> be the <a data-link-type="dfn">Social Agent</a> owner of the storage access is being granted from</p>
     <li data-md>
      <p>Let <code>APP</code> be <code>SUBJECT accessByApplication</code></p>
     <li data-md>
      <p>Let <code>RECEIPT fromAgent</code> be <code>OWNER</code></p>
     <li data-md>
      <p>Let <code>RECEIPT viaAgent</code> be <code>GRANTOR</code></p>
     <li data-md>
      <p>Let <code>RECEIPT providedAt</code> be the current time</p>
     <li data-md>
      <p>Let <code>RECEIPT hasAccessGrantSubject</code> be <code>SUBJECT</code></p>
     <li data-md>
      <p>Let <code>RECEIPT hasAccessNeedGroup</code> be all <a data-link-type="dfn">Access Need Groups</a> linked via <code>GRANT hasAccessNeedGroup</code></p>
     <li data-md>
      <p>Let <code>RECEIPT hasDataGrant</code> be all <a data-link-type="dfn">Data Grants</a> linked via <code>GRANT hasDataGrant</code></p>
     <li data-md>
      <p>Let <code>RECEIPT hasTrustedGrant</code> be all <a data-link-type="dfn">Trusted Grants</a> linked via <code>GRANT hasTrustedGrant</code></p>
     <li data-md>
      <p>Let <code>APPREG</code> be result of #appreg-loadappreg with
inputs: <code>OWNER</code>, <code>APP</code></p>
      <ol>
       <li data-md>
        <p>Call #appreg-registerapp if <code>APPREG</code> is empty</p>
      </ol>
     <li data-md>
      <p>Post <code>RECEIPT</code> to <code>APPREG</code> container</p>
     <li data-md>
      <p>Let <code>CURRENT</code> be <code>APPREG hasAccessReceipt</code></p>
     <li data-md>
      <p>Remove <code>CURRENT</code> if it exists</p>
     <li data-md>
      <p>Let <code>APPREG hasAccessReceipt</code> be <code>CURRENT</code></p>
     <li data-md>
      <p>Return <code>RECEIPT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.3" id="provide-receipt-in-message"><span class="secno">6.3. </span><span class="content">Provide Receipt in Message</span><a class="self-link" href="#provide-receipt-in-message"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
       <p>This operation provides an <a data-link-type="dfn">Access Receipt</a> for an <a data-link-type="dfn">Access Grant</a> to a given <a data-link-type="dfn">Agent</a> by delivering it to their access inbox.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>GRANT</code>
      <td><a data-link-type="dfn">Access Grant</a> to provide a receipt for
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Receipt</a>
      <td>for <code>GRANT</code> posted to the grantee <a data-link-type="dfn">Social Agent’s</a> access inbox
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>RECEIPT</code> be an empty <a data-link-type="dfn">Access Receipt</a></p>
     <li data-md>
      <p>Let <code>SUBJECT</code> be the <a data-link-type="dfn">Access Grant Subject</a> linked via <code>GRANT hasAccessGrantSubject</code></p>
     <li data-md>
      <p>Let <code>GRANTEE</code> be <code>SUBJECT accessByAgent</code></p>
     <li data-md>
      <p>Let <code>GRANTOR</code> be the current <a data-link-type="dfn">Social Agent</a></p>
     <li data-md>
      <p>Let <code>OWNER</code> be the <a data-link-type="dfn">Social Agent</a> owner of the storage access is being granted from</p>
     <li data-md>
      <p>Let <code>RECEIPT fromAgent</code> be <code>OWNER</code></p>
     <li data-md>
      <p>Let <code>RECEIPT viaAgent</code> be <code>GRANTOR</code></p>
     <li data-md>
      <p>Let <code>RECEIPT providedAt</code> be the current time</p>
     <li data-md>
      <p>Let <code>RECEIPT hasAccessGrantSubject</code> be <code>SUBJECT</code></p>
     <li data-md>
      <p>Let <code>RECEIPT hasAccessNeedGroup</code> be all <a data-link-type="dfn">Access Need Groups</a> linked via <code>GRANT hasAccessNeedGroup</code></p>
     <li data-md>
      <p>Let <code>RECEIPT hasDataGrant</code> be all <a data-link-type="dfn">Data Grants</a> linked via <code>GRANT hasDataGrant</code></p>
     <li data-md>
      <p>Let <code>RECEIPT hasTrustedGrant</code> be all <a data-link-type="dfn">Trusted Grants</a> linked via <code>GRANT hasTrustedGrant</code></p>
     <li data-md>
      <p>Post <code>RECEIPT</code> to <code>GRANTEE hasAccessInbox</code></p>
     <li data-md>
      <p>Return <code>RECEIPT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.4" id="record-access-receipt"><span class="secno">6.4. </span><span class="content">Record Access Receipt</span><a class="self-link" href="#record-access-receipt"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
       <p>This operation stores a new <a data-link-type="dfn">Access Receipt</a> in
      an <a data-link-type="dfn">Access Grant Registry</a></p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>RECEIPT</code>
      <td><a data-link-type="dfn">Access Receipt</a> to record
     <tr>
      <td><code>REGISTRY</code>
      <td><a data-link-type="dfn">Access Receipt Registry</a> to store receipts in
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Receipt</a>
      <td>Stored in <code>REGISTRY</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>Let <code>CURRENT</code> be an <a data-link-type="dfn">Access Receipt</a> returned by <a href="#load-access-receipt">§ 6.5 Load Access Receipt</a> with
inputs: <code>RECEIPT fromAgent</code>, <code>REGISTRY</code></p>
     <li data-md>
      <p>If <code>CURRENT</code> is empty</p>
      <ol>
       <li data-md>
        <p>Add <code>RECEIPT</code> to <code>REGISTRY</code></p>
       <li data-md>
        <p>Link <code>RECEIPT</code> to <code>REGISTRY</code> via <code>REGISTRY hasRegistration</code></p>
      </ol>
     <li data-md>
      <p>If <code>CURRENT</code> is not empty</p>
      <ol>
       <li data-md>
        <p>Update <code>CURRENT</code> with <code>RECEIPT</code></p>
      </ol>
     <li data-md>
      <p>Update the Agent Registry with inputs: <code>RECEIPT</code>.</p>
     <li data-md>
      <p>Return <code>RECEIPT</code></p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.5" id="load-access-receipt"><span class="secno">6.5. </span><span class="content">Load Access Receipt</span><a class="self-link" href="#load-access-receipt"></a></h3>
   <table align="left" class="data operation">
    <colgroup>
    <colgroup>
    <thead>
     <tr>
      <th colspan="2">Description
    <tbody>
     <tr>
      <td colspan="2">
       <p>This operation looks up an <a data-link-type="dfn">Access Receipt</a> in
      an <a data-link-type="dfn">Access Receipt Registry</a> <code>REGISTRY</code> based on the <a data-link-type="dfn">Agent</a> owner of the data that was shared.</p>
    <thead>
     <tr>
      <th colspan="2">Inputs
    <tbody>
     <tr>
      <td><code>AGENT</code>
      <td><a data-link-type="dfn">Social Agent</a> owner of the shared data
     <tr>
      <td><code>REGISTRY</code>
      <td><a data-link-type="dfn">Access Receipt Registry</a> to lookup
    <thead>
     <tr>
      <th colspan="2">Outputs
    <tbody>
     <tr>
      <td><a data-link-type="dfn">Access Receipt</a>
      <td>Corresponding to <code>AGENT</code> in <code>REGISTRY</code>
   </table>
   <div class="opdetails">
    <ol>
     <li data-md>
      <p>For each <a data-link-type="dfn">Access Receipt</a> <code>RECEIPT</code> included in <code>REGISTRY hasRegistration</code></p>
      <ol>
       <li data-md>
        <p>return <code>RECEIPT</code> if <code>RECEIPT fromAgent</code> == <code>AGENT</code></p>
      </ol>
    </ol>
   </div>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note. </p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-sai">[SAI]
   <dd>Justin Bingham; Eric Prud'hommeaux; elf Pavlik. <a href="https://solid.github.io/data-interoperability-panel/specification/"><cite>Solid Application Interoperability</cite></a>. URL: <a href="https://solid.github.io/data-interoperability-panel/specification/">https://solid.github.io/data-interoperability-panel/specification/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Cleanup of related data may need to be specified<a href="#issue-1c6aa834"> ↵ </a></div>
   <div class="issue"> Cleanup of related data may need to be specified<a href="#issue-1c6aa834①"> ↵ </a></div>
   <div class="issue"> Update this operation after refactoring of <a data-link-type="dfn">Delegated Data Grants</a><a href="#issue-7e591e60"> ↵ </a></div>
   <div class="issue"> Should we assume that CISERVICE is able to manage grants, or should
it need to redirect through the authorization agent? Perhaps the recommendation
should be that they are combined? Bad separation of concerns?<a href="#issue-d5f0eb31"> ↵ </a></div>
   <div class="issue"> This doesn’t take account a sequencing of validation steps from
one channel to another.<a href="#issue-d1e70f49"> ↵ </a></div>
   <div class="issue"> Define data authorization service<a href="#issue-abd7def3"> ↵ </a></div>
   <div class="issue"> Need to properly factor in multi-pod scenarios. Must identify the
proper access registry to store things in based on the data registration, which
means pods will also need to be registered.<a href="#issue-4a203aca"> ↵ </a></div>
   <div class="issue"> Write standard operation for invitation delivery<a href="#issue-2800f864"> ↵ </a></div>
   <div class="issue"> Write standard operation for validating an invitation<a href="#issue-00444ef2"> ↵ </a></div>
   <div class="issue"> Need to determine how to deal with objects that are
dynamic, where we need to match against more than one resource and
the subject identifier could? vary<a href="#issue-8ac7ce01"> ↵ </a></div>
  </div>